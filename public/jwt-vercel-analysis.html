<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê Vercel Authentication & CORS Analysis</title>
    <style>
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #3742fa 0%, #5f27cd 100%);
            color: white;
            line-height: 1.6;
        }
        .analysis-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            padding: 25px;
            margin: 20px 0;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .security { border-left: 5px solid #ff4757; }
        .info { border-left: 5px solid #3742fa; }
        .solution { border-left: 5px solid #2ed573; }
        
        .jwt-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            margin: 15px 0;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .decoded-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        button:hover { 
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .warning {
            background: rgba(255, 71, 87, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #ff4757;
        }
        
        .insight {
            background: rgba(46, 213, 115, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #2ed573;
        }
        
        code {
            background: rgba(0, 0, 0, 0.4);
            padding: 4px 8px;
            border-radius: 4px;
            font-family: 'Fira Code', monospace;
        }
    </style>
</head>
<body>
    <h1>üîê Vercel Authentication & CORS Analysis</h1>
    
    <div class="analysis-card security">
        <h2>üö® Security Notice: JWT Token Shared</h2>
        <div class="warning">
            <h3>‚ö†Ô∏è Important Security Information:</h3>
            <ul>
                <li><strong>You shared a JWT token</strong> - This contains authentication information</li>
                <li><strong>Token has expired</strong> - JWT expires in 10 seconds (timestamp shows expired)</li>
                <li><strong>No immediate risk</strong> - Token is already expired, but avoid sharing in future</li>
                <li><strong>Vercel SSO Protection</strong> - This is from Vercel's authentication system</li>
            </ul>
        </div>
    </div>

    <div class="analysis-card info">
        <h2>üîç JWT Token Analysis</h2>
        
        <h3>üìã Decoded JWT Information:</h3>
        <div class="decoded-section">
            <h4>Header:</h4>
            <code>{"alg":"HS256"}</code>
            
            <h4>Payload (Decoded):</h4>
            <ul>
                <li><strong>Subject:</strong> sso-protection-callback</li>
                <li><strong>Audience:</strong> massagewebsiteindastreet-7xi4kxkgo.vercel.app</li>
                <li><strong>User ID:</strong> fxm3SCUqTGODoTVtnUIRLCVF</li>
                <li><strong>Username:</strong> phillipofawell-8148</li>
                <li><strong>Issued At:</strong> 1763013598 (Nov 13, 2025)</li>
                <li><strong>Expires:</strong> 1763013608 (10 seconds later - EXPIRED)</li>
            </ul>
        </div>
        
        <div class="insight">
            <h3>üí° Key Insights:</h3>
            <ul>
                <li><strong>Confirms current URL:</strong> massagewebsiteindastreet-7xi4kxkgo.vercel.app</li>
                <li><strong>Vercel SSO active:</strong> Your project has password protection enabled</li>
                <li><strong>Short-lived token:</strong> 10-second expiry for security</li>
            </ul>
        </div>
    </div>

    <div class="analysis-card solution">
        <h2>üéØ How This Relates to Your CORS Issues</h2>
        
        <h3>üìä Current Situation Analysis:</h3>
        <div class="decoded-section">
            <h4>‚úÖ Confirmed Production URL:</h4>
            <p><code>massagewebsiteindastreet-7xi4kxkgo.vercel.app</code></p>
            
            <h4>‚ùå CORS Platform Configuration:</h4>
            <p>Still configured for old URL or localhost</p>
            
            <h4>üîê Vercel Protection:</h4>
            <p>SSO protection may be interfering with API calls</p>
        </div>
        
        <h3>üîß Recommended Actions:</h3>
        <ol>
            <li><strong>Update Appwrite Platform:</strong> Add the confirmed URL</li>
            <li><strong>Add Wildcard Domain:</strong> <code>*.vercel.app</code> for future deployments</li>
            <li><strong>Check Vercel Protection:</strong> Consider disabling SSO for API testing</li>
            <li><strong>Test Without Protection:</strong> Temporarily disable to isolate CORS issues</li>
        </ol>
    </div>

    <div class="analysis-card info">
        <h2>üöÄ Next Steps for CORS Fix</h2>
        
        <div class="insight">
            <h3>üéØ Immediate Actions:</h3>
            <ol>
                <li><strong>Sydney Appwrite Console:</strong> Add platform for confirmed URL</li>
                <li><strong>Add Wildcard:</strong> <code>*.vercel.app</code> to handle all future URLs</li>
                <li><strong>Vercel Settings:</strong> Check if SSO protection affects API calls</li>
                <li><strong>Test Access:</strong> Try both protected and unprotected environments</li>
            </ol>
        </div>
        
        <button onclick="openSydneyConsole()">üåè Open Sydney Console</button>
        <button onclick="checkVercelSettings()">‚öôÔ∏è Check Vercel Settings</button>
        <button onclick="testCurrentURL()">üß™ Test Current URL</button>
    </div>

    <div class="analysis-card security">
        <h2>üîí Security Best Practices</h2>
        
        <div class="warning">
            <h3>üõ°Ô∏è Future Security Tips:</h3>
            <ul>
                <li><strong>Never share JWT tokens</strong> - Even expired ones contain sensitive info</li>
                <li><strong>Use environment variables</strong> - For API keys and secrets</li>
                <li><strong>Short token lifespans</strong> - Your 10-second expiry is good practice</li>
                <li><strong>Rotate credentials</strong> - If accidentally shared</li>
            </ul>
        </div>
        
        <div class="insight">
            <h3>‚úÖ Good Security Practices Observed:</h3>
            <ul>
                <li>Short JWT expiration (10 seconds)</li>
                <li>Vercel SSO protection enabled</li>
                <li>Proper audience validation in token</li>
                <li>Secure nonce implementation</li>
            </ul>
        </div>
    </div>

    <script>
        function openSydneyConsole() {
            alert(`üåè Opening Sydney Appwrite Console

Add these platform entries:
1. *.vercel.app (wildcard)
2. massagewebsiteindastreet-7xi4kxkgo.vercel.app (current confirmed URL)
3. localhost (development)

The JWT confirmed your exact production URL!`);
            
            window.open('https://syd.cloud.appwrite.io/console', '_blank');
        }
        
        function checkVercelSettings() {
            alert(`‚öôÔ∏è Vercel Settings to Check:

1. Go to your Vercel dashboard
2. Find your massage website project
3. Check Settings ‚Üí Security
4. Look for "Password Protection" or "SSO Protection"
5. Consider temporarily disabling for CORS testing

SSO protection might interfere with API calls from external services.`);
            
            window.open('https://vercel.com/dashboard', '_blank');
        }
        
        function testCurrentURL() {
            alert(`üß™ Testing Confirmed Production URL:

URL from JWT: massagewebsiteindastreet-7xi4kxkgo.vercel.app

Will open this URL to test:
- CORS errors in console
- API functionality
- Appwrite connectivity

Check browser developer tools for errors!`);
            
            window.open('https://massagewebsiteindastreet-7xi4kxkgo.vercel.app', '_blank');
        }
        
        // Auto-analysis on load
        window.onload = function() {
            setTimeout(() => {
                alert(`üîê JWT Analysis Complete!

‚úÖ Confirmed production URL: massagewebsiteindastreet-7xi4kxkgo.vercel.app
‚ö†Ô∏è JWT token was expired (good security practice)
üîß Now we know exact URL to add to Appwrite platforms

Next: Add this confirmed URL + wildcard to Sydney console!`);
            }, 1000);
        };
    </script>
</body>
</html>