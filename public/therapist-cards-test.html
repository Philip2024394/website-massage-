<!DOCTYPE html>
<html>
<head>
    <title>Therapist Cards Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .result { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>üè† Therapist Cards Data Flow Test</h1>
    <div id="results"></div>

    <script src="https://cdn.jsdelivr.net/npm/appwrite@21.4.0"></script>
    <script>
        const { Client, Databases, Account } = Appwrite;

        // Updated configuration with correct IDs
        const client = new Client();
        client
            .setEndpoint('https://syd.cloud.appwrite.io/v1')
            .setProject('68f23b11000d25eb3664');

        const databases = new Databases(client);
        const account = new Account(client);

        const DATABASE_ID = '672b0d7b00249d81e129';
        const THERAPISTS_COLLECTION_ID = 'therapists_collection_id';
        const PLACES_COLLECTION_ID = 'places';

        async function testDataFlow() {
            const results = document.getElementById('results');
            
            try {
                results.innerHTML += '<div class="info">üîç Testing therapist data flow...</div>';
                
                // Test 1: Check therapists collection
                try {
                    const therapists = await databases.listDocuments(DATABASE_ID, THERAPISTS_COLLECTION_ID, []);
                    results.innerHTML += `<div class="success">‚úÖ Therapists collection: Found ${therapists.documents.length} therapists</div>`;
                } catch (error) {
                    results.innerHTML += `<div class="error">‚ùå Therapists collection error: ${error.message}</div>`;
                }

                // Test 2: Check places collection (this was the issue!)
                try {
                    const places = await databases.listDocuments(DATABASE_ID, PLACES_COLLECTION_ID, []);
                    results.innerHTML += `<div class="success">‚úÖ Places collection: Found ${places.documents.length} places</div>`;
                } catch (error) {
                    results.innerHTML += `<div class="error">‚ùå Places collection error: ${error.message}</div>`;
                }

                // Test 3: Check if therapists have place references
                try {
                    const therapists = await databases.listDocuments(DATABASE_ID, THERAPISTS_COLLECTION_ID, []);
                    if (therapists.documents.length > 0) {
                        const sample = therapists.documents[0];
                        const hasPlaceId = sample.placeId || sample.place || sample.location;
                        results.innerHTML += `<div class="${hasPlaceId ? 'success' : 'error'}">
                            ${hasPlaceId ? '‚úÖ' : '‚ùå'} Therapist-Place relationship: ${hasPlaceId ? 'Found place reference' : 'No place reference found'}
                        </div>`;
                    }
                } catch (error) {
                    results.innerHTML += `<div class="error">‚ùå Therapist-Place relationship test failed: ${error.message}</div>`;
                }

                results.innerHTML += '<div class="success">üéâ Data flow test completed!</div>';

            } catch (error) {
                results.innerHTML += `<div class="error">‚ùå General error: ${error.message}</div>`;
            }
        }

        // Run the test
        testDataFlow();
    </script>
</body>
</html>