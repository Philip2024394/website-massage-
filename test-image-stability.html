<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Image Stability Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border-left: 4px solid #4CAF50;
            background: #f9f9f9;
        }
        .image-test {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .image-container {
            position: relative;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            overflow: hidden;
            background: #f0f0f0;
        }
        .profile-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .profile-placeholder {
            display: none;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 28px;
            font-weight: 600;
            align-items: center;
            justify-content: center;
        }
        .status {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }
        .success { background: #4CAF50; color: white; }
        .fail { background: #f44336; color: white; }
        .pending { background: #ff9800; color: white; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üñºÔ∏è Profile Image Stability Test</h1>
        <p>Testing the new stable image placeholder system for therapist cards.</p>

        <div class="test-section">
            <h3>‚úÖ Working Profile Image (Tata)</h3>
            <div class="image-test">
                <div class="image-container">
                    <img 
                        class="profile-image" 
                        src="https://cloud.appwrite.io/v1/storage/buckets/68f76bdd002387590584/files/6911a37398c3353f6e64/view?project=67160f1a0000776afce9" 
                        alt="Tata Profile"
                        onload="updateStatus('tata-status', 'success', 'Image loaded successfully')"
                        onerror="updateStatus('tata-status', 'fail', 'Failed to load')"
                    />
                    <div class="profile-placeholder">T</div>
                </div>
                <div>
                    <strong>Tata (Real Profile Image)</strong><br>
                    <span id="tata-status" class="status pending">Loading...</span>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>üîß Fixed Placeholder System</h3>
            
            <div class="image-test">
                <div class="image-container">
                    <img 
                        class="profile-image" 
                        src="invalid-image-url-that-will-fail" 
                        alt="Phil4 Profile"
                        onload="updateStatus('phil4-status', 'success', 'Image loaded')"
                        onerror="showPlaceholder(this, 'phil4-status', 'P')"
                    />
                    <div class="profile-placeholder">P</div>
                </div>
                <div>
                    <strong>Phil4 (Stable Placeholder)</strong><br>
                    <span id="phil4-status" class="status pending">Loading...</span>
                </div>
            </div>

            <div class="image-test">
                <div class="image-container">
                    <img 
                        class="profile-image" 
                        src="another-invalid-url" 
                        alt="Other Therapist Profile"
                        onload="updateStatus('other-status', 'success', 'Image loaded')"
                        onerror="showPlaceholder(this, 'other-status', 'T')"
                    />
                    <div class="profile-placeholder">T</div>
                </div>
                <div>
                    <strong>Other Therapist (Stable Placeholder)</strong><br>
                    <span id="other-status" class="status pending">Loading...</span>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>üìä Test Results</h3>
            <div id="results">
                <p>üîÑ Running tests...</p>
            </div>
        </div>
    </div>

    <script>
        function updateStatus(statusId, type, message) {
            const statusEl = document.getElementById(statusId);
            statusEl.className = `status ${type}`;
            statusEl.textContent = message;
            updateResults();
        }

        function showPlaceholder(imgElement, statusId, letter) {
            console.log('Image failed, showing placeholder for:', statusId);
            imgElement.style.display = 'none';
            const placeholder = imgElement.parentElement.querySelector('.profile-placeholder');
            if (placeholder) {
                placeholder.textContent = letter;
                placeholder.style.display = 'flex';
                updateStatus(statusId, 'success', 'Stable placeholder shown');
            } else {
                updateStatus(statusId, 'fail', 'Placeholder not found');
            }
        }

        function updateResults() {
            setTimeout(() => {
                const statuses = document.querySelectorAll('.status');
                const success = document.querySelectorAll('.status.success').length;
                const fail = document.querySelectorAll('.status.fail').length;
                const pending = document.querySelectorAll('.status.pending').length;

                const results = document.getElementById('results');
                results.innerHTML = `
                    <p><strong>Test Summary:</strong></p>
                    <p>‚úÖ Successful: ${success}</p>
                    <p>‚ùå Failed: ${fail}</p>
                    <p>üîÑ Pending: ${pending}</p>
                    <p><strong>Status:</strong> ${pending === 0 ? 
                        (fail === 0 ? 'üéâ All tests passed! No more flashing images.' : '‚ö†Ô∏è Some issues detected.') : 
                        '‚è≥ Tests still running...'}</p>
                `;
            }, 1000);
        }

        // Run initial test
        updateResults();
    </script>
</body>
</html>