/* üåê GLOBAL SCROLLING STANDARDS - FOLLOWING WEB BEST PRACTICES */

/* RULE #1: DOCUMENT/BODY LEVEL SCROLLING - SINGLE SCROLL AUTHORITY */
html {
  width: 100%;
  height: 100%;
  overflow-x: hidden;
}

body {
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  position: relative;
}

/* RULE #2: PREVENT SCROLL-JACKING - Allow natural browser behavior */
/* Only override problematic height patterns that conflict with natural scrolling */
@media (max-width: 768px) {
  /* Mobile-specific: Convert viewport-dependent layouts to content-dependent */
  .h-screen:not(.preserve-height),
  .min-h-screen:not(.preserve-height) {
    min-height: 100vh !important;
    height: auto !important;
  }
  
  /* Override fixed viewport heights that prevent scrolling */
  *[style*="height: 100vh"]:not(.preserve-height),
  *[style*="height: 100dvh"]:not(.preserve-height) {
    min-height: 100vh !important;
    height: auto !important;
  }
}

/* RULE #3: SAFE LAYOUT PATTERNS - STANDARDS COMPLIANT */
.safe-page-wrapper {
  min-height: 100vh;
  overflow: visible;
}

.safe-page-wrapper main {
  min-height: auto;
  overflow: visible;
  padding-bottom: env(safe-area-inset-bottom, 20px);
}

/* RULE #4: STICKY HEADERS ARE ALLOWED - BUT NO BODY LOCKING */
.safe-header {
  position: sticky;
  top: 0;
  z-index: 50;
  background: white;
}
/* RULE #5: COMPONENT-SPECIFIC SCROLL HANDLING */
/* Therapist dashboard - Natural content flow */
.therapist-dashboard,
.therapist-page-container {
  min-height: 100vh;
  overflow: visible;
}

.therapist-content,
.therapist-layout-content {
  min-height: auto;
  overflow: visible;
  padding-bottom: 2rem;
}

/* RULE #6: MODALS & OVERLAYS - CONTAINED SCROLLING */
.chat-messages {
  max-height: 60vh;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

.chat-window {
  position: fixed;
  max-height: 80vh;
  overflow-y: auto;
  z-index: 9999;
  /* Allow internal scrolling while maintaining page scroll */
}

/* CRITICAL: Never lock body scroll for overlays */
body.modal-open,
body.chat-open {
  overflow-y: auto !important;
  position: relative !important;
}

.modal-backdrop {
  position: fixed;
  inset: 0;
  z-index: 1000;
  /* Backdrop only - no scroll locking */
}

.modal-content {
  max-height: 90vh;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

/* RULE #7: PWA & MOBILE BROWSER COMPATIBILITY */
@media (max-width: 768px) {
  /* Ensure body always remains scrollable */
  body {
    overflow-y: auto !important;
    position: relative !important;
    touch-action: manipulation;
  }
  
  /* Let page containers grow naturally */
  .page-container {
    min-height: 100vh;
    height: auto;
    overflow: visible;
  }
  
  /* Main content areas should never constrain height */
  main:not(.preserve-height) {
    min-height: auto !important;
    height: auto !important;
    max-height: none !important;
    overflow: visible !important;
  }
  
  /* Container elements should allow natural flow */
  .container:not(.preserve-height),
  .max-w-sm:not(.preserve-height),
  .max-w-md:not(.preserve-height),
  .max-w-lg:not(.preserve-height) {
    max-height: none !important;
    overflow: visible !important;
  }
}

/* RULE #8: EXCEPTIONS DOCUMENTATION */
/* Components that require fixed heights should use .preserve-height class */
.preserve-height {
  /* This class exempts elements from global scroll normalization */
  /* Use sparingly and only when absolutely necessary */
}

/* RULE #9: SAFE TOUCH INTERACTIONS */
* {
  /* Prevent zoom on double-tap while allowing scroll */
  touch-action: manipulation;
}

input, textarea, select {
  /* Allow normal input interactions */
  touch-action: auto;
}