/**
 * ðŸ”’ HEIGHT LOCK ELIMINATION - MODEL A COMPLIANCE
 * 
 * RULE: NO container may use height: 100vh when header is position: sticky
 * ONLY min-height: 100vh is allowed for natural content growth
 * 
 * This file provides defensive fixes to eliminate ALL height locks
 * that prevent natural scrolling in therapist dashboard.
 */

/* ============================================================================
 * THERAPIST DASHBOARD HEIGHT LOCK FIXES
 * ============================================================================ */

/* Force remove any height locks on main layout containers */
.therapist-page-container,
.therapist-layout-content,
.therapist-content-wrapper,
.therapist-dashboard-page,
.therapist-page-main {
  /* âŒ FORBIDDEN: height: 100vh, max-height: 100vh */
  height: auto !important;
  max-height: none !important;
  
  /* âœ… REQUIRED: min-height only for natural growth */
  min-height: auto !important;
  
  /* âœ… REQUIRED: overflow visible for natural scrolling */
  overflow: visible !important;
  overflow-y: visible !important;
  overflow-x: visible !important;
}

/* Ensure AppShell doesn't create height constraints */
.app-shell,
.app-shell main {
  height: auto !important;
  max-height: none !important;
  overflow: visible !important;
}

/* Ensure body and html allow natural growth */
html,
body,
#root {
  height: auto !important;
  max-height: none !important;
  overflow-x: hidden !important;
  overflow-y: visible !important;
}

/* ============================================================================
 * FLEX CONTAINER HEIGHT FIXES
 * ============================================================================ */

/* Main must NOT grow (flex: 0) so content sits under header with no white gap.
   flex: 1 1 auto was causing main to fill viewport below header = empty white space. */
.therapist-page-container main,
.therapist-layout-content main,
[class*="therapist"] main {
  flex: 0 1 auto !important;
  height: auto !important;
  max-height: none !important;
  overflow: visible !important;
}

/* ============================================================================
 * DIAGNOSTIC HELPERS (Remove after confirming fix)
 * ============================================================================ */

/* Uncomment to visualize container boundaries
.therapist-page-container { outline: 2px solid red !important; }
.therapist-layout-content { outline: 2px solid blue !important; }
.therapist-content-wrapper { outline: 2px solid green !important; }
*/

/* âœ… FIX: White gap = margin (no box). Restore sticky header so content flows naturally. */
.therapist-layout-header {
  position: sticky !important; /* Override index.css fixed - sticky keeps header in flow, no offset needed */
}
.therapist-page-container main,
.therapist-page-container .therapist-layout-content,
.therapist-page-container .therapist-content-wrapper,
.therapist-layout-content,
.therapist-content-wrapper,
.therapist-content-wrapper > *:first-child,
.therapist-content-wrapper > * {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

/* CRITICAL: Payment Status works because TherapistPageHeader is first; other pages use
   min-h-[calc(100vh-...)] on root which creates white space. Override to match Payment Status. */
.therapist-content-wrapper > * {
  min-height: 0 !important;
}

/* ============================================================================
 * MOBILE FIX: White space under header (desktop OK, mobile shows gap)
 * Cause: body padding-top + 100vh/min-height on mobile viewport
 * ============================================================================ */

@media (max-width: 768px) {
  /* Therapist dashboard: no body top padding (header handles safe area) */
  body:has(.therapist-page-container) {
    padding-top: 0 !important;
    padding-left: env(safe-area-inset-left, 0) !important;
    padding-right: env(safe-area-inset-right, 0) !important;
    padding-bottom: env(safe-area-inset-bottom, 0) !important;
  }
  /* Header absorbs safe area so content starts immediately below */
  .therapist-page-container .therapist-layout-header {
    padding-top: env(safe-area-inset-top, 0) !important;
    min-height: calc(60px + env(safe-area-inset-top, 0px)) !important;
    height: auto !important;
  }
  /* #root: use 100dvh on mobile to avoid 100vh "tall viewport" gap */
  #root:has(.therapist-page-container) {
    min-height: 100dvh !important;
  }
  /* Prevent any content wrapper from creating extra top space */
  .therapist-page-container .therapist-layout-content,
  .therapist-page-container .therapist-content-wrapper,
  .therapist-page-container main {
    margin-top: 0 !important;
    padding-top: 0 !important;
    min-height: 0 !important;
  }
}
