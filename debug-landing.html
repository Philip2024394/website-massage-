<!DOCTYPE html>
<html>
<head>
    <title>Landing Page Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .error { background: #ffebee; border: 1px solid #f44336; }
        .success { background: #e8f5e9; border: 1px solid #4caf50; }
    </style>
</head>
<body>
    <h1>Landing Page Debug Test</h1>
    
    <div class="test">
        <h3>Test 1: Direct Server Connection</h3>
        <button onclick="testServer()">Test Server Connection</button>
        <div id="server-test"></div>
    </div>
    
    <div class="test">
        <h3>Test 2: Load Landing Page</h3>
        <button onclick="testLanding()">Test Landing Page</button>
        <div id="landing-test"></div>
    </div>
    
    <div class="test">
        <h3>Test 3: Check Console Errors</h3>
        <button onclick="checkConsole()">Check Console</button>
        <div id="console-test"></div>
    </div>

    <script>
        function testServer() {
            const result = document.getElementById('server-test');
            result.innerHTML = 'Testing...';
            
            fetch('http://127.0.0.1:3003/')
                .then(response => {
                    if (response.ok) {
                        result.innerHTML = '<div class="success">✅ Server is responding (Status: ' + response.status + ')</div>';
                        return response.text();
                    } else {
                        result.innerHTML = '<div class="error">❌ Server error (Status: ' + response.status + ')</div>';
                    }
                })
                .then(html => {
                    if (html) {
                        result.innerHTML += '<details><summary>Response HTML Preview</summary><pre>' + html.substring(0, 500) + '...</pre></details>';
                    }
                })
                .catch(error => {
                    result.innerHTML = '<div class="error">❌ Connection failed: ' + error.message + '</div>';
                });
        }
        
        function testLanding() {
            const result = document.getElementById('landing-test');
            result.innerHTML = 'Opening landing page...';
            
            // Try to open the landing page in a popup
            const popup = window.open('http://127.0.0.1:3003/', '_blank', 'width=800,height=600');
            
            setTimeout(() => {
                try {
                    if (popup.closed) {
                        result.innerHTML = '<div class="error">❌ Popup was blocked or closed immediately</div>';
                    } else {
                        result.innerHTML = '<div class="success">✅ Landing page opened in new window</div>';
                    }
                } catch (e) {
                    result.innerHTML = '<div class="error">❌ Cross-origin access blocked: ' + e.message + '</div>';
                }
            }, 2000);
        }
        
        function checkConsole() {
            const result = document.getElementById('console-test');
            const errors = [];
            
            // Override console methods to capture errors
            const originalError = console.error;
            const originalWarn = console.warn;
            
            console.error = function(...args) {
                errors.push('ERROR: ' + args.join(' '));
                originalError.apply(console, args);
            };
            
            console.warn = function(...args) {
                errors.push('WARN: ' + args.join(' '));
                originalWarn.apply(console, args);
            };
            
            if (errors.length > 0) {
                result.innerHTML = '<div class="error">Found console messages:<br>' + errors.join('<br>') + '</div>';
            } else {
                result.innerHTML = '<div class="success">✅ No console errors captured</div>';
            }
        }
    </script>
</body>
</html>