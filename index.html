<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover, interactive-widget=resizes-content" />
    
    <!-- üöÄ DNS PREFETCH: Pre-resolve domains for instant resource loading -->
    <link rel="dns-prefetch" href="//syd.cloud.appwrite.io">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    
    <!-- üöÄ CRITICAL PERFORMANCE: Module preload removed - Vite handles bundling -->
    <!-- Preloading /src/index.tsx caused "preloaded but not used" warning - entry is loaded as type="module" -->
    <link rel="preconnect" href="https://syd.cloud.appwrite.io" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    
    <!-- ‚úÖ Cache control managed by Netlify headers, not meta tags -->
    
    <!-- ‚úÖ MOBILE-FIRST: Critical CSS for first paint loading state -->
    <!-- Prevents 5-10 second blank white screen on slow 3G/4G connections -->
    <style>
        /* Elite Loading System - Skeleton UI for instant perceived performance */
        
        /* Prevent layout shift */
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f97316;
        }
        #root {
            min-height: 100vh;
        }
        
        /* Elite Skeleton Loading - Renders instantly while React loads */
        #root:empty {
            display: block;
            background: #f97316;
            min-height: 100vh;
            position: relative;
        }
        
        /* Header Skeleton */
        #root:empty::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
            z-index: 1;
        }
        
        /* Logo Skeleton */
        #root:empty::after {
            content: 'IndaStreet';
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 24px;
            font-weight: bold;
            z-index: 2;
        }
        
        /* Content Area Skeleton */
        .skeleton-content {
            position: absolute;
            top: 100px;
            left: 0;
            right: 0;
            padding: 20px;
            display: none; /* HIDDEN: Redundant with PWA splash, prevents white flash */
        }
        
        /* Card Skeletons - ORANGE THEME to prevent white flash */
        .skeleton-card {
            background: rgba(255, 255, 255, 0.1); /* Transparent white on orange */
            border-radius: 12px;
            margin-bottom: 16px;
            padding: 16px;
            position: relative;
            overflow: hidden;
        }
        
        .skeleton-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: shimmer 1.5s infinite;
        }
        
        .skeleton-line {
            height: 12px;
            background: rgba(255, 255, 255, 0.15); /* Light white overlay */
            border-radius: 6px;
            margin-bottom: 8px;
        }
        
        .skeleton-line.title {
            height: 20px;
            width: 70%;
            background: rgba(255, 255, 255, 0.2); /* Slightly more visible */
        }
        
        .skeleton-line.subtitle {
            width: 50%;
        }
        
        .skeleton-line.content {
            width: 90%;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        /* Loading indicator */
        .elite-loading {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(249, 115, 22, 0.95);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            z-index: 1000;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(249, 115, 22, 0.3);
        }
        
        .elite-loading .dots {
            display: flex;
            gap: 4px;
        }
        
        .elite-loading .dot {
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            animation: dotPulse 1.4s infinite ease-in-out;
        }
        
        .elite-loading .dot:nth-child(1) { animation-delay: 0s; }
        .elite-loading .dot:nth-child(2) { animation-delay: 0.2s; }
        .elite-loading .dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes dotPulse {
            0%, 60%, 100% { opacity: 0.3; transform: scale(1); }
            30% { opacity: 1; transform: scale(1.2); }
        }
        
        /* Hide skeleton when React loads */
        #root:not(:empty) .skeleton-content,
        #root:not(:empty) .elite-loading {
            display: none;
        }
    </style>
    
    <!-- üîÑ MOBILE PULL-TO-REFRESH: Allow native mobile refresh gesture -->
    <style>
        /* Allow pull-to-refresh on mobile while preventing back/forward navigation */
        html, body {
            overscroll-behavior-y: auto;
            overscroll-behavior-x: none;
        }
        /* Prevent mobile browser horizontal overscroll navigation; keep vertical scroll enabled */
        body {
            position: relative;
            overflow-x: hidden;
            overflow-y: auto;
        }
        /* Ensure mobile view can scroll: root grows with content */
        @media (max-width: 768px) {
            html, body {
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            }
        }
    </style>
    
    <!-- Preview mode: Auto-refresh disabled to prevent flashing -->
    <script>
        // Stable preview mode - no auto-refresh
        console.log('üì± Preview mode active - stable connection');
    </script>
    
    <!-- üì± PWA MANIFEST: Critical for background notifications -->
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#f97316" />
    
    <!-- üì± FULL-SCREEN PWA: Hide browser UI completely -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="apple-mobile-web-app-title" content="IndaStreet" />
    <link rel="apple-touch-icon" href="https://ik.imagekit.io/7grri5v7d/indastreet_massage_button-removebg-preview.png" />
    
    <!-- Android Chrome specific -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="IndaStreet" />
    
    <!-- PWA Splash Screens -->
    <link rel="apple-touch-startup-image" href="https://ik.imagekit.io/7grri5v7d/indastreet%20massage.png" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    
    <!-- Prevent page zoom on form inputs for Android -->
    <meta name="HandheldFriendly" content="true" />
    
    <!-- ‚úÖ Cache control managed by Netlify HTTP headers, not meta tags -->
    
    <!-- Primary Meta Tags - SEO Optimized for Global Coverage -->
    <title>IndaStreet - Global Massage & Wellness Directory | 200+ Cities in 6 Countries</title>
    <meta name="title" content="IndaStreet - Global Massage & Wellness Directory | Professional Therapists Worldwide" />
    <meta name="description" content="Find professional massage therapists, luxury spas & wellness services worldwide. Coverage in Indonesia, Philippines, UK, USA, Australia, Germany. 200+ cities, 2000+ verified professionals. Instant booking available." />
    <meta name="keywords" content="massage directory, massage therapist, spa services, wellness directory, massage worldwide, spa booking, professional massage, massage Indonesia, massage USA, massage UK, massage Australia, massage Germany, massage Philippines, home massage service, hotel massage, verified therapists, instant booking, mobile massage, outcall massage, wellness services" />
    <meta name="author" content="IndaStreet - Global Massage & Wellness Directory" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="language" content="English, Indonesian, German, Filipino" />
    <meta name="revisit-after" content="1 day" />
    <meta name="rating" content="general" />
    <meta name="distribution" content="global" />
    <meta name="coverage" content="Worldwide" />
    
    <!-- Geo Meta Tags - Global Coverage -->
    <meta name="geo.region" content="ID;PH;GB;US;AU;DE" />
    <meta name="geo.placename" content="Indonesia, Philippines, United Kingdom, United States, Australia, Germany" />
    <meta name="geo.coverage" content="Jakarta, Manila, London, New York, Sydney, Berlin, Bali, Tokyo, Los Angeles, Melbourne, Munich, Birmingham" />
    
    <!-- Open Graph / Facebook - Enhanced -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.indastreetmassage.com/" />
    <meta property="og:title" content="IndaStreet - Global Massage & Wellness Directory | 200+ Cities Worldwide" />
    <meta property="og:description" content="Find professional massage therapists, spas & wellness services in 6 countries. Indonesia, Philippines, UK, USA, Australia, Germany. 2000+ verified professionals. Instant booking." />
    <meta property="og:image" content="https://ik.imagekit.io/7grri5v7d/Massage%20hub%20indastreet.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:locale:alternate" content="id_ID" />
    <meta property="og:locale:alternate" content="de_DE" />
    <meta property="og:locale:alternate" content="tl_PH" />
    <meta property="og:site_name" content="IndaStreet" />
    <meta property="fb:app_id" content="YOUR_FACEBOOK_APP_ID" />
    
    <!-- Twitter - Enhanced -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://www.indastreetmassage.com/" />
    <meta property="twitter:title" content="IndaStreet - Global Massage & Wellness Directory" />
    <meta property="twitter:description" content="Find verified massage therapists & wellness services in 6 countries. 200+ cities, 2000+ professionals. Instant booking available." />
    <meta property="twitter:image" content="https://ik.imagekit.io/7grri5v7d/Massage%20hub%20indastreet.png" />
    <meta property="twitter:site" content="@indastreet" />
    <meta property="twitter:creator" content="@indastreet" />
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="https://ik.imagekit.io/7grri5v7d/indastreet_massage_button-removebg-preview.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#f97316" />
    <!-- Canonical -->
    <link rel="canonical" href="https://www.indastreetmassage.com/" />
    
    <!-- Alternate Language Links for Global SEO -->
    <link rel="alternate" hreflang="en" href="https://www.indastreetmassage.com/" />
    <link rel="alternate" hreflang="id" href="https://www.indastreetmassage.com/id" />
    <link rel="alternate" hreflang="de" href="https://www.indastreetmassage.com/de" />
    <link rel="alternate" hreflang="tl" href="https://www.indastreetmassage.com/ph" />
    <link rel="alternate" hreflang="en-GB" href="https://www.indastreetmassage.com/gb" />
    <link rel="alternate" hreflang="en-US" href="https://www.indastreetmassage.com/us" />
    <link rel="alternate" hreflang="en-AU" href="https://www.indastreetmassage.com/au" />
    <link rel="alternate" hreflang="en-PH" href="https://www.indastreetmassage.com/ph?lang=en" />
    <link rel="alternate" hreflang="x-default" href="https://www.indastreetmassage.com/" />
    
    <!-- RSS Feed -->
    <link rel="alternate" type="application/rss+xml" title="IndaStreet - Global Updates" href="https://www.indastreetmassage.com/rss-global.xml" />
    
    <!-- Structured Data - Global Organization -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "IndaStreet",
      "alternateName": "IndaStreet Global Massage & Wellness Directory",
      "description": "Global Massage & Wellness Directory connecting users with professional therapists and spa services in 6 countries: Indonesia, Philippines, UK, USA, Australia, Germany. 200+ cities, 2000+ verified professionals.",
      "image": [
        "https://ik.imagekit.io/7grri5v7d/Massage%20hub%20indastreet.png",
        "https://ik.imagekit.io/7grri5v7d/indastreet%20massage%20logo.png"
      ],
      "@id": "https://www.indastreetmassage.com",
      "url": "https://www.indastreetmassage.com",
      "telephone": "+62-813-9200-0050",
      "email": "indastreet.id@gmail.com",
      "sameAs": [
        "https://www.facebook.com/indastreet",
        "https://www.instagram.com/indastreet",
        "https://twitter.com/indastreet"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "Customer Service",
        "availableLanguage": ["English", "Indonesian", "German", "Filipino"]
      },
      "areaServed": [
        {
          "@type": "Country",
          "name": "Indonesia",
          "sameAs": "https://www.indastreetmassage.com/id"
        },
        {
          "@type": "Country",
          "name": "Philippines",
          "sameAs": "https://www.indastreetmassage.com/ph"
        },
        {
          "@type": "Country",
          "name": "United Kingdom",
          "sameAs": "https://www.indastreetmassage.com/gb"
        },
        {
          "@type": "Country",
          "name": "United States",
          "sameAs": "https://www.indastreetmassage.com/us"
        },
        {
          "@type": "Country",
          "name": "Australia",
          "sameAs": "https://www.indastreetmassage.com/au"
        },
        {
          "@type": "Country",
          "name": "Germany",
          "sameAs": "https://www.indastreetmassage.com/de"
        }
      ]
    }
    </script>
    
    <!-- Structured Data - WebSite with Search -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "IndaStreet",
      "url": "https://www.indastreetmassage.com",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://www.indastreetmassage.com/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      },
      "inLanguage": ["en", "id", "de", "tl"]
    }
    </script>
    
    <!-- Social Media Hashtags for Global SEO -->
    <meta name="hashtags" content="#MassageTherapy #WellnessDirectory #GlobalSpa #MassageIndonesia #MassageUK #MassageUSA #MassageAustralia #MassageGermany #MassagePhilippines #SpaBooking #TherapistDirectory #WorldwideMassage #MassageLondon #MassageNYC #MassageSydney #MassageBerlin #MassageManila #MassageJakarta #MassageBali" />
    
    <style>
        /* Hide scrollbar for navigation buttons */
        .overflow-x-auto::-webkit-scrollbar {
            display: none;
        }
        
        /* Smooth fade-in for initial load */
        #root {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>
    <!-- 
        ========================================================================
                                  GOOGLE MAPS SETUP
        ========================================================================
        The Google Maps API Key is now managed within the application.
        To enable location features:
        1. Log in to the Admin Dashboard.
        2. Navigate to the "Google Maps API Key" section.
        3. Enter your valid API key and save.
        
        The app will automatically load the Maps API once the key is provided.
        Get a key from the Google Cloud Console: https://console.cloud.google.com/google/maps-apis
        ========================================================================
    -->
    <style>
        /* Hide scrollbar for Chrome, Safari and Opera */
        *::-webkit-scrollbar {
            display: none;
        }

        /* Hide scrollbar for IE, Edge and Firefox */
        * {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        
        /* PWA Splash Screen - Orange IndaStreet Brand Design (matches LoadingGate) */
        #pwa-splash {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: #FF7A00;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          z-index: 9999;
          opacity: 1;
          transition: opacity 0.3s ease-out;
        }
        
        #pwa-splash.hidden {
          opacity: 0;
          pointer-events: none;
        }
        
        #pwa-splash .brand-title {
          font-size: 42px;
          font-weight: 700;
          margin: 0 0 10px 0;
          letter-spacing: -0.5px;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
          animation: fadeIn 0.8s ease-out;
        }
        
        #pwa-splash .brand-title .inda {
          color: #ffffff;
        }
        
        #pwa-splash .brand-title .street {
          color: #ffffff;
        }
        
        #pwa-splash .loading-label {
          color: #ffffff;
          font-size: 18px;
          font-weight: 500;
          margin: 0 0 16px 0;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
          animation: fadeIn 0.8s ease-out 0.2s both;
        }
        
        #pwa-splash .dots-container {
          display: flex;
          gap: 8px;
          align-items: center;
        }
        
        /* Dancing dots animation - white color */
        .loading-dot {
          width: 12px;
          height: 12px;
          border-radius: 50%;
          background: #ffffff;
          animation: dotBounce 1.4s ease-in-out infinite;
        }
        
        .loading-dot:nth-child(1) {
          animation-delay: 0s;
        }
        
        .loading-dot:nth-child(2) {
          animation-delay: 0.2s;
        }
        
        .loading-dot:nth-child(3) {
          animation-delay: 0.4s;
        }
        
        @keyframes dotBounce {
          0%, 80%, 100% {
            transform: translateY(0);
          }
          40% {
            transform: translateY(-12px);
          }
        }
        
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
    </style>
    
    <!-- Social Media Hashtags for Global SEO -->
    <meta name="hashtags" content="#MassageTherapy #WellnessDirectory #GlobalSpa #MassageIndonesia #MassageUK #MassageUSA #MassageAustralia #MassageGermany #MassagePhilippines #SpaBooking #TherapistDirectory #WorldwideMassage #MassageLondon #MassageNYC #MassageSydney #MassageBerlin #MassageManila #MassageJakarta #MassageBali" />
    
</head>
<body style="background-color: #f97316;">
    <!-- PWA Splash Screen - Indastreet Loading -->
    <div id="pwa-splash">
      <div class="brand-title"><span class="inda">Inda</span><span class="street">street</span></div>
      <div class="loading-label">Professional Massage Services</div>
      <div class="dots-container">
        <span class="loading-dot"></span>
        <span class="loading-dot"></span>
        <span class="loading-dot"></span>
      </div>
    </div>
    
    <div id="root">
        <!-- Elite Skeleton Loading - Shows instantly while React loads -->
        <div class="skeleton-content">
            <!-- Search Bar Skeleton -->
            <div class="skeleton-card">
                <div class="skeleton-line title"></div>
                <div class="skeleton-line subtitle"></div>
            </div>
            
            <!-- Provider Cards Skeleton -->
            <div class="skeleton-card">
                <div class="skeleton-line title"></div>
                <div class="skeleton-line content"></div>
                <div class="skeleton-line" style="width: 60%;"></div>
            </div>
            
            <div class="skeleton-card">
                <div class="skeleton-line title"></div>
                <div class="skeleton-line content"></div>
                <div class="skeleton-line" style="width: 40%;"></div>
            </div>
            
            <div class="skeleton-card">
                <div class="skeleton-line title"></div>
                <div class="skeleton-line content"></div>
                <div class="skeleton-line" style="width: 70%;"></div>
            </div>
        </div>
        
        <!-- Elite Loading Indicator -->
        <div class="elite-loading">
            <span>Loading IndaStreet</span>
            <div class="dots">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
        </div>
    </div>
  <!-- Dedicated overlay root for portals (toasts, modals, etc.) -->
  <div id="overlay-root"></div>
    
    <!-- Hide splash screen after React loads -->
    <script>
      (function() {
        var splashHidden = false;
        var contentReady = false;
        
        // Hide splash smoothly
        function hideSplash() {
          if (splashHidden) return;
          splashHidden = true;
          
          var splash = document.getElementById('pwa-splash');
          if (splash) {
            splash.style.opacity = '0';
            setTimeout(function() {
              if (splash.parentNode) {
                splash.remove();
              }
            }, 300);
          }
        }
        
        // Check if landing page, loading gate, or app is ready
        function isLandingPageReady() {
          var root = document.getElementById('root');
          if (!root || root.children.length === 0) return false;
          
          // FAST: Hide when React has rendered landing page (explicit signal from MainLandingPage)
          if (root.querySelector('[data-landing-page="ready"]')) {
            return true;
          }
          // FAST: Hide when React has rendered loading gate (orange screen - seamless transition)
          if (root.querySelector('[data-loading-gate]')) {
            return true;
          }
          // IGNORE React loading states - wait for real content
          if (root.querySelector('#react-loading-spinner, .loading-spinner, [data-loading-state]')) {
            return false;
          }
          // Skeleton has single spinner - avoid false positive from AppShellSkeleton
          var spinnerCount = root.querySelectorAll('.animate-spin').length;
          var hasSkeletonOnly = spinnerCount > 0 && root.querySelectorAll('img').length === 0 && !root.querySelector('input');
          
          // Require ACTUAL content - landing, home, or therapist dashboard
          var hasProviderCards = root.querySelectorAll('.therapist-card, .provider-card, .PlaceCard, .TherapistCard, [class*="TherapistCard"]').length > 0;
          var hasSearchSection = root.querySelector('input[type="search"], .search-input, [placeholder*="Search"], [placeholder*="Cari"]') !== null;
          var hasMainContent = root.querySelector('.main-content, .landing-page, .home-page, .landing-page-container, .MainLandingPage, .MainHomePage, .app-shell') !== null;
          var hasTherapistDashboard = root.querySelector('.therapist-layout-header, .therapist-page-container, .therapist-layout-content') !== null;
          var hasNavigationMenu = root.querySelectorAll('nav, .nav, .navigation, .GlobalHeader, header').length > 0;
          var hasImages = root.querySelectorAll('img[src*="imagekit"], img[src*="appwrite"], img[src*="cloud"]').length > 0;
          var hasRichText = root.textContent && root.textContent.trim().length > 500;
          
          // Skip if we only have skeleton (spinner but no real content)
          if (hasSkeletonOnly) return false;
          
          // Must have strong indicators of real content
          var contentScore = 0;
          if (hasProviderCards) contentScore += 3;
          if (hasMainContent || hasTherapistDashboard) contentScore += 2;
          if (hasSearchSection) contentScore += 2;
          if (hasNavigationMenu) contentScore += 1;
          if (hasImages) contentScore += 1;
          if (hasRichText) contentScore += 1;
          
          if (contentScore >= 2) {
            console.log('[SPLASH] Page ready - Score:', contentScore);
          }
          return contentScore >= 2;
        }
        
        // Wait for React content with enhanced landing page detection
        var checkInterval = setInterval(function() {
          if (isLandingPageReady()) {
            console.log('[SPLASH] Landing page ready - hiding splash screen');
            clearInterval(checkInterval);
            // Smooth transition for better UX
            setTimeout(hideSplash, 100);
          }
        }, 50); // Check more frequently
        
        // Max timeout: Hide splash after 5s (handles slow connections)
        setTimeout(function() {
          if (!splashHidden) {
            console.log('[SPLASH] Timeout reached (5s) - hiding splash screen');
            clearInterval(checkInterval);
            hideSplash();
          }
        }, 5000);
      })();
    </script>
    
    <!-- CACHE BUSTER: 2024-10-31-10:05:00 -->
    <script type="module" src="/src/index.tsx?v=20241031100500"></script>
    <script>
      // üî•üî•üî• TEMPORARY P0 FIX: Force-kill all service workers to fix stuck loading issue
      // Remove this after 48 hours once all users have received new build
      // Date activated: February 8, 2026
      if ('serviceWorker' in navigator) {
        console.log('üî• [P0 FIX] Force-killing all service workers...');
        navigator.serviceWorker.getRegistrations().then((regs) => {
          regs.forEach((reg) => {
            reg.unregister();
            console.log('üßπ [P0 FIX] Unregistered service worker:', reg.scope);
          });
        }).catch((err) => {
          console.error('‚ùå [P0 FIX] Failed to unregister service workers:', err);
        });
        
        // Clear all caches
        if ('caches' in window) {
          caches.keys().then((names) => {
            names.forEach(name => {
              caches.delete(name);
              console.log('üßπ [P0 FIX] Deleted cache:', name);
            });
          });
        }
      }
      
      // üÜî App version tracking for cache busting
      window.APP_VERSION = '2026.02.08.001';
      window.BUILD_TIMESTAMP = Date.now();
      console.log('üÜî App Version:', window.APP_VERSION);
      
      // Note: All console errors will now display naturally as per system honesty requirements
      // This includes 401/501 authentication errors which are expected when not logged in
      
      // üì± PWA SERVICE WORKER: Disabled temporarily for P0 fix
      // TODO: Re-enable after confirming all users received new build (after Feb 10, 2026)
      if (false && 'serviceWorker' in navigator) {
        const isLocal = ['localhost', '127.0.0.1'].includes(window.location.hostname);

        if (isLocal) {
          // Proactively unregister any SWs when developing locally
          navigator.serviceWorker.getRegistrations().then((regs) => {
            regs.forEach((reg) => reg.unregister());
            console.log('üßπ Unregistered existing service workers on localhost');
          });
        } else if (window.location.protocol === 'https:') {
          // Only register in production (HTTPS) environments
          window.addEventListener('load', function() {
            navigator.serviceWorker.register('/sw.js')
              .then(function(registration) {
                console.log('‚úÖ PWA Service Worker registered:', registration.scope);

                // Enable install prompt for "Add to Home Screen"
                // Store prompt for user-triggered install (e.g., via button click)
                window.deferredPrompt = null;
                window.addEventListener('beforeinstallprompt', (e) => {
                  e.preventDefault();
                  window.deferredPrompt = e;
                  console.log('üì± PWA install prompt ready - call window.deferredPrompt.prompt() on user action');
                });

                // Note: Install prompt must be triggered by user gesture (button click)
                // To show install UI, create a button that calls:
                // window.deferredPrompt?.prompt()
              })
              .catch(function(error) {
                console.log('‚ùå PWA Service Worker registration failed:', error);
              });
          });
        }
      }
    </script>
</body>
</html>
