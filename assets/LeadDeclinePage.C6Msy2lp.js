import{a as l,j as e,am as x,v as r,ae as h,T as b}from"./vendor-react.DJgHGAhw.js";import{j as p}from"./route-therapist.DVVqC6AH.js";import"./vendor-appwrite.BT2H32tF.js";import{C as j,A as y}from"./vendor-misc.BCNplu90.js";import"./route-booking.yuk30L8G.js";import"./route-portals.BJGRQhN_.js";const D=()=>{const{leadId:s}=j(),o=y(),[g,d]=l.useState(!0),[n,m]=l.useState(!1),[a,i]=l.useState(null),t=new URLSearchParams(window.location.search).get("token");l.useEffect(()=>{u()},[s]);const u=async()=>{if(!s||!t){i({success:!1,message:"Invalid lead URL"}),d(!1);return}d(!1)},f=async()=>{if(!(!s||!t)){m(!0);try{const c=await p.declineLead(s,t);i(c),c.success&&setTimeout(()=>{window.opener?window.close():o("/")},3e3)}catch{i({success:!1,message:"Error processing decline"})}finally{m(!1)}}};return g?e.jsx("div",{className:"min-h-[calc(100vh-env(safe-area-inset-top)-env(safe-area-inset-bottom))] bg-gradient-to-br from-gray-50 to-white flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(x,{className:"w-12 h-12 text-gray-500 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):a?e.jsx("div",{className:"min-h-[calc(100vh-env(safe-area-inset-top)-env(safe-area-inset-bottom))] bg-gradient-to-br from-gray-50 to-white flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center",children:a.success?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"w-20 h-20 text-blue-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Lead Declined"}),e.jsx("p",{className:"text-gray-600 mb-6",children:a.message}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"âœ“ No charges applied"}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Customer will be notified and offered an alternative"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"This window will close automatically in 3 seconds..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"w-20 h-20 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:a.message}),e.jsx("button",{onClick:()=>window.close(),className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Close Window"})]})})}):e.jsx("div",{className:"min-h-[calc(100vh-env(safe-area-inset-top)-env(safe-area-inset-bottom))] bg-gradient-to-br from-gray-50 to-white flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(b,{className:"w-8 h-8 text-yellow-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Decline This Lead?"}),e.jsx("p",{className:"text-gray-600",children:"Confirm that you cannot accept this booking"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 mb-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(r,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"No charge for declining"})]}),e.jsxs("div",{className:"flex items-start gap-2 text-blue-600",children:[e.jsx(r,{className:"w-5 h-5 mt-0.5"}),e.jsx("span",{className:"text-sm",children:"Customer will be notified and offered an alternative provider"})]}),e.jsxs("div",{className:"flex items-start gap-2 text-gray-600",children:[e.jsx(r,{className:"w-5 h-5 mt-0.5"}),e.jsx("span",{className:"text-sm",children:"Lead will be marked as declined in your history"})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," Frequent declines may affect your future lead priority. Only decline if you truly cannot fulfill this booking."]})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:f,disabled:n,className:"flex-1 bg-gradient-to-r from-gray-500 to-gray-600 text-white font-bold py-4 rounded-xl hover:from-gray-600 hover:to-gray-700 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"w-5 h-5"}),"Confirm Decline"]})}),e.jsx("button",{onClick:()=>o("/lead/accept/".concat(s,"?token=").concat(t)),disabled:n,className:"flex-1 bg-green-500 text-white font-bold py-4 rounded-xl hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Go Back"})]}),e.jsx("p",{className:"text-xs text-center text-gray-500 mt-4",children:"You can close this window without taking action"})]})})};export{D as default};
