import{a as j,j as e,ac as w,q as $,p as W,W as Y}from"./vendor-react.DJgHGAhw.js";import{U as H,B as K,l as v,ae as I,af as A,e as _}from"./route-therapist.DVVqC6AH.js";import{F as V}from"./FloatingPageFooter.BEXmstKk.js";import"./vendor-appwrite.BT2H32tF.js";import"./route-booking.yuk30L8G.js";import"./vendor-misc.BCNplu90.js";import"./route-portals.BJGRQhN_.js";function q(o=new Date){const s=new Date(Date.UTC(o.getFullYear(),o.getMonth(),o.getDate())),c=s.getUTCDay()||7;s.setUTCDate(s.getUTCDate()+4-c);const l=new Date(Date.UTC(s.getUTCFullYear(),0,1)),h=Math.ceil(((s.getTime()-l.getTime())/864e5+1)/7);return{year:s.getUTCFullYear(),week:h}}function z(o){let s=0;for(let c=0;c<o.length;c++)s=(s<<5)-s+o.charCodeAt(c)|0;return Math.abs(s)}function G(o){return function(){let s=o+=1831565813;return s=Math.imul(s^s>>>15,s|1),s^=s+Math.imul(s^s>>>7,s|61),((s^s>>>14)>>>0)/4294967296}}function L(o){const{year:s,week:c}=q(),l=(o||"all").trim().toLowerCase(),h="".concat(s,"-W").concat(c,"-").concat(l);return z(h)}function y(o,s){const c=G(s);for(let l=o.length-1;l>0;l--){const h=Math.floor(c()*(l+1));[o[l],o[h]]=[o[h],o[l]]}return o}const J=7,Q=80,ie=({t:o,language:s,therapists:c=[],onNavigate:l,onSelectTherapist:h,userCity:g})=>{const[N,T]=j.useState(!1),[i,C]=j.useState(s||"en"),[M,B]=j.useState(new Set),S=a=>{C(a)},P=a=>{B(r=>new Set(r).add(a))},D=a=>{const r=a.lastSeen||a.$updatedAt||a.updatedAt;if(!r)return!1;const n=new Date(r);return isNaN(n.getTime())?!1:(Date.now()-n.getTime())/(1e3*60*60*24)<=J},O=a=>{var d,t;const r=(a.rating||0)*(Math.max(0,a.reviewCount||0)+1),n=a.totalBookings||a.reviewCount||0,p=!!(a.pricing&&(a.pricing[60]||a.pricing[90]||a.pricing[120]||a.services&&a.services.length>0)),u=a.isVerified||a.verifiedBadge?100:0,x=a.$updatedAt||a.updatedAt?10:0,m=((t=(d=a.missedBookingsCount)!=null?d:a.missedBookings)!=null?t:0)*Q;return Math.max(0,r*2+n*5+(p?50:0)+u+x-m)},R=a=>{const r=a.isLive===!0||typeof a.isLive!="boolean"&&a.isLive!==!1,n=(a.status||a.availability||a.availabilityStatus||"").toString().trim().toLowerCase();return!!(r&&(n==="available"||n==="online"))},U=()=>{v.debug("ðŸ† [TOP5] Filtering therapists",{totalCount:c.length,userCity:g});let a=c.filter(t=>R(t)&&D(t));g&&(a=a.filter(t=>t.city&&String(t.city).toLowerCase()===g.toLowerCase()));const r=a.map(t=>({therapist:t,score:O(t)}));r.sort((t,f)=>f.score-t.score);const n=r.slice(0,20).map(t=>t.therapist);if(n.length<=5)return n;const p=L(g||null),u=n[0],x=n.slice(1),m=y([...x],p),d=[u,...m.slice(0,4)];return v.debug("ðŸ† [TOP5] Top 5 this week",{count:d.length,userCity:g,weekSeed:p}),d},b=j.useMemo(()=>U(),[c,g]),k=j.useMemo(()=>{var f;const a={0:"most-popular"};if(b.length<2)return a;const n=L(g||null)+12345,u=y([1,2,3,4].filter(E=>E<b.length),n).slice(0,2),m=y([...["newest-menu-prices","rating-climbing","booking-success"]],n+1),d=m[0];let t=m[1];return d==="newest-menu-prices"&&t==="newest-menu-prices"&&(t=(f=m[2])!=null?f:"rating-climbing"),a[u[0]]=d,a[u[1]]=t,a},[b.length,g]),F=a=>{const r=a.$id||a.id||a.name,n=a.profilePicture||a.profileImageUrl||a.profileImage;return n&&!n.startsWith("data:")?n:a.mainImage&&!a.mainImage.startsWith("data:")?a.mainImage:I(r)};return e.jsxs("div",{className:"min-h-[calc(100vh-env(safe-area-inset-top)-env(safe-area-inset-bottom))] bg-white",children:[e.jsx(H,{language:i,onLanguageChange:S,onMenuClick:()=>T(!0),isMenuOpen:N,menuIcon:e.jsx(K,{}),onNavigate:l,showLanguageSwitch:!0,className:"sticky top-0 z-40"}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-center mb-8 -mt-10",children:e.jsx("img",{src:"https://ik.imagekit.io/7grri5v7d/indastreet%20massage%20logo.png?updatedAt=1764533351258",alt:"Indastreet Massage Logo",className:"w-60 h-60 object-contain mx-auto mb-4"})}),e.jsxs("h2",{className:"text-3xl font-bold text-gray-900 mb-2 flex items-center gap-3 justify-center",children:[e.jsx("span",{className:"text-4xl",children:"ðŸ†"}),i==="id"?"Top 5 Terapis":"Top 5 Therapists"]}),e.jsx("p",{className:"text-gray-600 text-lg mb-2 text-center",children:i==="id"?"Trending Bulan Ini untuk Performa dan Layanan Terbaik.":"Trending This Month For Top Performance And Service."}),g&&e.jsx("div",{className:"flex justify-center mb-4",children:e.jsxs("div",{className:"px-6 py-3 rounded-full bg-orange-500 text-white font-semibold shadow-md flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“"}),e.jsx("span",{children:g})]})}),e.jsxs("div",{className:"mb-6 rounded-2xl border border-slate-200/80 bg-slate-50 p-5 text-left",children:[e.jsx("h3",{className:"text-base font-bold text-slate-900 mb-3",children:i==="id"?"Mengapa Terapis Ini Masuk Top 5?":"Why Are These Therapists in the Top 5?"}),e.jsx("p",{className:"text-slate-600 text-sm mb-3 leading-relaxed",children:i==="id"?"Top 5 profesional kami diakui karena konsisten memberikan layanan berkualitas tinggi dan mempertahankan standar profesional yang kuat. Pemilihan berdasarkan performa keseluruhan dan kepuasan klien, dan terapis yang ditampilkan diperbarui secara berkala untuk menonjolkan berbagai profesional unggulan.":"Our Top 5 professionals are recognized for consistently delivering high-quality service and maintaining strong professional standards. Selection is based on overall performance and client satisfaction, and the featured therapists are refreshed regularly to highlight a variety of outstanding professionals."}),e.jsx("p",{className:"text-slate-700 text-sm font-semibold mb-2",children:i==="id"?"Pemilihan berdasarkan:":"Selection is based on:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-orange-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:i==="id"?"Ulasan Klien yang Sangat Baik â€“ Umpan balik positif yang konsisten dari klien.":"Excellent Client Reviews â€“ Consistently positive feedback from clients."})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-orange-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:i==="id"?"Kehadiran Aktif & Mapan â€“ Keandalan dan keterlibatan berkelanjutan di platform.":"Active & Established Presence â€“ Demonstrated reliability and ongoing engagement on the platform."})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-orange-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:i==="id"?"Performa Booking yang Kuat â€“ Permintaan tinggi dan janji temu klien yang konsisten.":"Strong Booking Performance â€“ High demand and consistent client appointments."})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-orange-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:i==="id"?"Informasi Layanan Lengkap â€“ Menu layanan yang jelas dan rinci serta harga transparan.":"Comprehensive Service Information â€“ Clear, detailed service menus and transparent pricing."})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-orange-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:i==="id"?"Standar Akun Profesional â€“ Profil yang terpelihara dengan baik dan memenuhi standar kualitas platform.":"Professional Account Standing â€“ Well-maintained profiles that meet platform quality standards."})]})]}),e.jsx("p",{className:"text-slate-600 text-sm mt-3 leading-relaxed",children:i==="id"?"Profesional unggulan kami dirotasi secara berkala agar beragam terapis berkinerja terbaik mendapat visibilitas.":"Our featured professionals rotate periodically to ensure visibility for a diverse range of top-performing therapists."})]})]}),b.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:i==="id"?"Belum ada data terapis.":"No therapist data available yet."})}):e.jsx("div",{className:"space-y-4",children:b.map((a,r)=>{const n=a.$id||a.id||a.name,p=F(a),u=M.has(n),x=a.totalBookings||a.reviewCount||0,m=a.rating||0;return v.debug("ðŸ† [TOP5] Rendering therapist #".concat(r+1),{id:n,name:a.name,bookings:x,rating:m,city:a.city}),e.jsxs("div",{className:"bg-white border-2 border-gray-100 rounded-2xl p-5 hover:border-orange-300 hover:shadow-lg transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative w-20 h-20 flex-shrink-0",children:[!u&&e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-gray-200 to-gray-300 animate-pulse border-4 border-white shadow-lg"}),e.jsx("img",{src:p,alt:A(a.name),className:"w-20 h-20 rounded-full object-cover border-4 border-white shadow-lg transition-opacity duration-300 ".concat(u?"opacity-100":"opacity-0"),onLoad:()=>P(n),onError:d=>{P(n);const t=I(n+"-fallback");d.target.src=t}})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg mb-2 truncate",children:A(a.name)}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-orange-600 font-semibold",children:[e.jsx($,{className:"w-4 h-4"}),e.jsxs("span",{children:[x," ",i==="id"?"booking":"bookings"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-yellow-600 font-semibold",children:[e.jsx(W,{className:"w-4 h-4 fill-yellow-500"}),e.jsxs("span",{children:[m>0?m.toFixed(1):"New"," (",a.reviewCount||0,")"]})]}),a.city&&e.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[e.jsx("span",{children:"ðŸ“"}),e.jsx("span",{children:a.city})]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1.5",children:i==="id"?"Masuk Top 5: ulasan, booking, menu lengkap, kesehatan akun.":"In Top 5 for: reviews, bookings, detailed menu, account health."})]}),e.jsxs("button",{onClick:()=>{const d=a.$id||a.id,t=(a.name||"therapist").toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");v.debug("ðŸ† [TOP5] View profile clicked",{id:d,name:a.name});try{h&&h(a),typeof window!="undefined"&&window.history&&window.history.pushState({},"","#/therapist-profile/".concat(d,"-").concat(t)),l&&l("therapist-profile")}catch(f){v.error("ðŸ† [TOP5] Navigation failed",f)}},className:"flex-shrink-0 px-5 py-2.5 bg-orange-500 hover:bg-orange-600 text-white font-semibold rounded-xl transition-colors shadow-md flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:i==="id"?"Lihat":"View"})]})]}),k[r]&&e.jsx("div",{className:"mt-3 text-center",children:e.jsxs("span",{className:"inline-block px-4 py-1 bg-gradient-to-r from-yellow-100 to-orange-100 text-yellow-800 font-bold text-xs rounded-full",children:[k[r]==="most-popular"&&e.jsxs(e.Fragment,{children:["ðŸ† ",i==="id"?"TERAPIS TERPOPULER":"MOST POPULAR THERAPIST"]}),k[r]==="newest-menu-prices"&&e.jsx(e.Fragment,{children:i==="id"?"âœ¨ Menu & Harga Terbaru":"âœ¨ Newest Menu & Prices"}),k[r]==="rating-climbing"&&e.jsx(e.Fragment,{children:i==="id"?"ðŸ“ˆ Rating Naik":"ðŸ“ˆ Account Rating Climbing"}),k[r]==="booking-success"&&e.jsx(e.Fragment,{children:i==="id"?"âœ… 98% Booking Sukses":"âœ… 98% Booking Success"})]})})]},n)})})]}),e.jsx("div",{className:"mt-16",children:e.jsx(V,{currentLanguage:i,onNavigate:l})}),e.jsx(_,{isOpen:N,onClose:()=>T(!1),onNavigate:l||(()=>{}),currentLanguage:i,onLanguageChange:S})]})};export{ie as default};
