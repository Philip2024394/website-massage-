import{a as r,j as e,h as P,I as R,N as L,a5 as A,ae as k,v as m,S as D,n as V}from"./vendor-react.DJgHGAhw.js";import{f as b}from"./App.1fxTHtx8.js";import"./route-therapist.DVVqC6AH.js";import"./vendor-appwrite.BT2H32tF.js";import"./route-booking.yuk30L8G.js";import"./vendor-misc.BCNplu90.js";import"./route-portals.BJGRQhN_.js";import"./vendor-ui.D6Y-8hbd.js";import"./route-payment.T2FKxZVj.js";const Y=({placeId:i,placeName:p})=>{const[a,h]=r.useState(null),[u,c]=r.useState(!0),[x,l]=r.useState(!1),[n,N]=r.useState(""),[d,f]=r.useState([]),[g,y]=r.useState([]),[j,v]=r.useState(!1);r.useEffect(()=>{w()},[i]);const w=async()=>{c(!0);try{const s=await b.getApplicationByEntity("place",i);h(s)}catch{}finally{c(!1)}},F=s=>{if(s.target.files){const t=Array.from(s.target.files);f(o=>[...o,...t])}},I=s=>{f(t=>t.filter((o,U)=>U!==s))},E=async()=>{if(d.length===0)return alert("Please select at least one document to upload"),!1;v(!0);try{const s=[];for(const t of d){const o=await b.uploadLetter(t);s.push(o)}return y(s),!0}catch{return alert("Error uploading files. Please try again."),!1}finally{v(!1)}},C=async s=>{if(s.preventDefault(),d.length===0){alert("Please upload at least one supporting document");return}if(!n.trim()){alert("Please provide a payment reference ID");return}l(!0);try{let t=g;if(g.length===0){if(!await E()){l(!1);return}t=g}await b.submitApplication({entityType:"place",entityId:i,entityName:p,hotelVillaLetters:t,safePassPaymentId:n}),alert("SafePass application submitted successfully!"),await w(),N(""),f([]),y([])}catch{alert("Error submitting application. Please try again.")}finally{l(!1)}},S=()=>{if(!a)return null;switch(a.hotelVillaSafePassStatus){case"pending":return e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(V,{className:"w-6 h-6 text-yellow-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"Application Under Review"}),e.jsx("p",{className:"text-yellow-800 text-sm",children:"Your SafePass application is being reviewed by our admin team. You will be notified once a decision is made."}),e.jsxs("p",{className:"text-yellow-700 text-xs mt-2",children:["Submitted: ",new Date(a.safePassSubmittedAt).toLocaleDateString()]})]})]})});case"approved":return e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(m,{className:"w-6 h-6 text-blue-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Application Approved"}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Your SafePass application has been approved! Your SafePass certification is being prepared and will be activated soon."}),e.jsxs("p",{className:"text-blue-700 text-xs mt-2",children:["Approved: ",new Date(a.safePassApprovedAt).toLocaleDateString()]})]})]})});case"active":return e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(D,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"SafePass Active ✓"}),e.jsx("p",{className:"text-green-800 text-sm mb-3",children:"Your SafePass is active! Your establishment is now certified to host professional massage therapists with proper safety and quality standards."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700",children:"Issued:"}),e.jsx("span",{className:"ml-2 font-medium",children:new Date(a.safePassIssuedAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-green-700",children:"Expires:"}),e.jsx("span",{className:"ml-2 font-medium",children:new Date(a.safePassExpiry).toLocaleDateString()})]})]}),a.safePassCardUrl&&e.jsxs("a",{href:a.safePassCardUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 mt-4 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors",children:[e.jsx(A,{className:"w-4 h-4"}),"View SafePass Certificate"]})]})]})});case"rejected":return e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(k,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"Application Rejected"}),e.jsx("p",{className:"text-red-800 text-sm mb-2",children:"Unfortunately, your SafePass application was not approved."}),a.safePassRejectionReason&&e.jsx("div",{className:"bg-red-100 border border-red-300 rounded p-3 mt-3",children:e.jsxs("p",{className:"text-red-900 text-sm",children:[e.jsx("strong",{children:"Reason:"})," ",a.safePassRejectionReason]})}),e.jsx("p",{className:"text-red-700 text-xs mt-3",children:"You can submit a new application after addressing the issues mentioned above."})]})]})});default:return null}};return u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600"})}):a&&a.hotelVillaSafePassStatus!=="rejected"?e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(P,{className:"w-8 h-8 text-orange-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"SafePass Status"})]}),S()]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(P,{className:"w-8 h-8 text-orange-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Apply for SafePass"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(R,{className:"w-6 h-6 text-blue-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"What is SafePass for Places?"}),e.jsx("p",{className:"text-blue-800 text-sm mb-3",children:"SafePass certification ensures your establishment meets industry standards for hosting professional massage therapists. It provides assurance to both therapists and guests about safety, quality, and professional service delivery."}),e.jsxs("ul",{className:"text-blue-800 text-sm space-y-1",children:[e.jsx("li",{children:"✓ Verified safe and professional environment"}),e.jsx("li",{children:"✓ Access to certified therapist network"}),e.jsx("li",{children:"✓ Enhanced guest satisfaction"}),e.jsx("li",{children:"✓ Valid for 2 years"})]})]})]})}),a&&a.hotelVillaSafePassStatus==="rejected"&&e.jsx("div",{className:"mb-6",children:S()}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Submit Application"}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Reference ID *"}),e.jsx("input",{type:"text",value:n,onChange:s=>N(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Enter payment transaction ID",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Transfer SafePass fee and enter your payment reference number"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Supporting Documents *"}),e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Upload required documents (business license, facility photos, safety certifications, etc.)"}),e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(L,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, PNG (max 10MB each)"})]}),e.jsx("input",{type:"file",onChange:F,multiple:!0,accept:".pdf,.jpg,.jpeg,.png",className:"hidden"})]}),d.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:d.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:s.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",(s.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsx("button",{type:"button",onClick:()=>I(t),className:"text-red-600 hover:text-red-700",children:e.jsx(k,{className:"w-5 h-5"})})]},t))})]}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Application Requirements:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Valid payment proof for SafePass fee"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Business license or registration certificate"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Facility photos showing massage service areas"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Safety and hygiene certifications"})]})]})]}),e.jsx("button",{type:"submit",disabled:x||j,className:"w-full py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:x||j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),j?"Uploading documents...":"Submitting application..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-5 h-5"}),"Submit SafePass Application"]})})]})]})]})})},X=()=>{const[i,p]=r.useState(""),[a,h]=r.useState(""),[u,c]=r.useState(!0);r.useEffect(()=>{x()},[]);const x=async()=>{try{const l=localStorage.getItem("placeId"),n=localStorage.getItem("placeName");if(!l||!n){c(!1);return}p(l),h(n)}catch{}finally{c(!1)}};return u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600"})}):!i||!a?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Place Not Found"}),e.jsx("p",{className:"text-gray-600",children:"Please log in to access SafePass application."})]})}):e.jsx(Y,{placeId:i,placeName:a})};export{X as default};
