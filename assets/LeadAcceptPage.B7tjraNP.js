import{a as r,j as e,am as g,v as j,ae as p,L as b,m as L,w as C,M as P,q as S,n as u}from"./vendor-react.DJgHGAhw.js";import{j as f}from"./route-therapist.DVVqC6AH.js";import"./vendor-appwrite.BT2H32tF.js";import{C as k,A}from"./vendor-misc.BCNplu90.js";import"./route-booking.yuk30L8G.js";import"./route-portals.BJGRQhN_.js";const U=()=>{var x,h;const{leadId:a}=k(),o=A(),[N,d]=r.useState(!0),[i,m]=r.useState(!1),[l,c]=r.useState(null),[s,y]=r.useState(null),n=new URLSearchParams(window.location.search).get("token");r.useEffect(()=>{w()},[a]);const w=async()=>{if(!a||!n){c({success:!1,message:"Invalid lead URL"}),d(!1);return}try{const t=await f.getMemberLeads(a);t.length>0&&y(t[0])}catch{}finally{d(!1)}},v=async()=>{if(!(!a||!n)){m(!0);try{const t=await f.acceptLead(a,n);c(t),t.success&&setTimeout(()=>{window.opener?window.close():o("/")},5e3)}catch{c({success:!1,message:"Error processing acceptance"})}finally{m(!1)}}};return N?e.jsx("div",{className:"min-h-[calc(100vh-env(safe-area-inset-top)-env(safe-area-inset-bottom))] bg-gradient-to-br from-orange-50 to-white flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(g,{className:"w-12 h-12 text-orange-500 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading lead details..."})]})}):l?e.jsx("div",{className:"min-h-[calc(100vh-env(safe-area-inset-top)-env(safe-area-inset-bottom))] bg-gradient-to-br from-orange-50 to-white flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center",children:l.success?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-20 h-20 text-green-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Lead Accepted!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l.message}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-sm text-green-800 font-medium mb-2",children:"‚úÖ Lead Accepted - Commission Details:"}),e.jsxs("ul",{className:"text-xs text-green-700 space-y-1 mb-3",children:[e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Amount Due:"})," Rp ",((h=(x=l.lead)==null?void 0:x.leadCost)==null?void 0:h.toLocaleString())||"0"," (25% commission)"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Payment Deadline:"})," Within 7 days of month-end invoice"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Invoice Date:"})," 1st of next month"]})]}),e.jsx("p",{className:"text-xs text-green-600 border-t border-green-200 pt-2",children:"üì± Customer has been notified and will contact you shortly via WhatsApp"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"This window will close automatically in 5 seconds..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"w-20 h-20 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Cannot Accept Lead"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l.message}),e.jsx("button",{onClick:()=>window.close(),className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Close Window"})]})})}):e.jsx("div",{className:"min-h-[calc(100vh-env(safe-area-inset-top)-env(safe-area-inset-bottom))] bg-gradient-to-br from-orange-50 to-white flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(b,{className:"w-8 h-8 text-orange-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Accept Booking Lead?"}),e.jsx("p",{className:"text-gray-600",children:"Review the details below before accepting"})]}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 mb-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(L,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Customer"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.customerName})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(C,{className:"w-5 h-5 text-blue-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Communication"}),e.jsx("p",{className:"font-semibold text-blue-900",children:"Use in-app chat system"})]})]}),s.customerLocation&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Location"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.customerLocation}),s.hotelVillaName&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.hotelVillaName," ",s.roomNumber&&"- Room ".concat(s.roomNumber)]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(S,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Requested Time"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.requestedDateTime}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Duration: ",s.duration," minutes"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(u,{className:"w-5 h-5 text-gray-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Service Type"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.serviceType})]})]}),s.notes&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Additional Notes"}),e.jsx("p",{className:"text-gray-700",children:s.notes})]})]}),e.jsxs("div",{className:"bg-orange-50 border-2 border-orange-200 rounded-xl p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(b,{className:"w-6 h-6 text-orange-600"}),e.jsx("h3",{className:"text-lg font-bold text-orange-900",children:"Lead Cost - 25% Commission"})]}),e.jsxs("p",{className:"text-3xl font-bold text-orange-600 mb-2",children:["Rp ",((s==null?void 0:s.leadCost)||0).toLocaleString()]}),e.jsxs("p",{className:"text-sm text-orange-700 mb-3",children:["This is 25% of the booking price (Rp ",((s==null?void 0:s.bookingPrice)||0).toLocaleString(),"), payable to IndaStreet."]}),e.jsxs("div",{className:"bg-white/70 rounded-lg p-3 border border-orange-300",children:[e.jsx("p",{className:"text-sm font-semibold text-orange-900 mb-1",children:"üí∞ Payment Terms:"}),e.jsxs("ul",{className:"text-xs text-orange-800 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Added to your monthly invoice"}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:"Payment due within 7 days of month-end"})]}),e.jsx("li",{children:"‚Ä¢ No charge if you decline this lead"})]})]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6 flex items-start gap-3",children:[e.jsx(u,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"‚è∞ This lead expires in 5 minutes"}),e.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"If you don't respond, it will be sent to other providers"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:v,disabled:i,className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white font-bold py-4 rounded-xl hover:from-green-600 hover:to-green-700 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-5 h-5"}),"Accept Lead"]})}),e.jsxs("button",{onClick:()=>o("/lead/decline/".concat(a,"?token=").concat(n)),disabled:i,className:"flex-1 bg-gray-200 text-gray-700 font-bold py-4 rounded-xl hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(p,{className:"w-5 h-5"}),"Decline"]})]}),e.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 mt-4",children:[e.jsx("p",{className:"text-xs text-center text-gray-700 font-medium mb-2",children:"‚ö†Ô∏è By accepting, you agree to:"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("li",{children:["‚úì Pay Rp ",((s==null?void 0:s.leadCost)||0).toLocaleString()," (25% commission) to IndaStreet"]}),e.jsx("li",{children:"‚úì Payment due within 7 days of month-end invoice"}),e.jsx("li",{children:"‚úì Contact customer immediately to confirm booking"})]})]})]})]})})};export{U as default};
