import{j as e,p as C,t as oe,q as de,n as ce,a as r,J as me,u as b,w as _,m as ge}from"./vendor-react.DJgHGAhw.js";import{f as P,r as K}from"./route-therapist.DVVqC6AH.js";import"./vendor-appwrite.BT2H32tF.js";import"./route-booking.yuk30L8G.js";import"./vendor-misc.BCNplu90.js";import"./route-portals.BJGRQhN_.js";const xe=({review:s,showOwnerResponse:c=!0})=>{const m=c&&s.rating<4;return e.jsx("div",{className:"bg-white rounded-xl shadow-md hover:shadow-lg transition-shadow p-6 border border-gray-100",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4 sm:w-1/3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center shadow-lg overflow-hidden",children:e.jsx("img",{src:s.avatar,alt:s.userName,className:"w-full h-full object-cover"})})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg truncate",children:s.userName}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[[1,2,3,4,5].map(g=>e.jsx(C,{className:"w-5 h-5 ".concat(g<=s.rating?"fill-yellow-400 text-yellow-400":"fill-gray-200 text-gray-300")},g)),e.jsxs("span",{className:"ml-2 text-sm font-semibold text-gray-700",children:[s.rating,".0"]})]})]})]}),e.jsxs("div",{className:"flex-grow sm:w-1/3",children:[e.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:s.reviewText}),m&&e.jsxs("div",{className:"mt-3 flex items-start gap-2 p-3 bg-blue-50 border-l-4 border-blue-500 rounded",children:[e.jsx(oe,{className:"w-4 h-4 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs text-blue-800 font-medium",children:"Owner Addressed The Concern"})]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-start gap-2 sm:w-1/4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-lg",children:[e.jsx(de,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"font-medium",children:s.date})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-lg",children:[e.jsx(ce,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"font-medium",children:s.time})]})]})]})})},he=[{id:1,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%201.png",label:"Avatar 1"},{id:2,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%202.png",label:"Avatar 2"},{id:3,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%203.png",label:"Avatar 3"},{id:4,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%204.png",label:"Avatar 4"},{id:5,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%206.png",label:"Avatar 6"},{id:6,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%207.png",label:"Avatar 7"},{id:7,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%208.png",label:"Avatar 8"},{id:8,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%209.png",label:"Avatar 9"},{id:9,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%2010.png",label:"Avatar 10"},{id:10,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%2011.png",label:"Avatar 11"},{id:11,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%2012.png",label:"Avatar 12"},{id:12,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%2013.png",label:"Avatar 13"},{id:13,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%2014.png",label:"Avatar 14"},{id:14,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%2015.png",label:"Avatar 15"},{id:15,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%2016.png",label:"Avatar 16"},{id:16,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%2017.png",label:"Avatar 17"},{id:17,imageUrl:"https://ik.imagekit.io/7grri5v7d/avatar%2018.png",label:"Avatar 18"}],ye=({providerId:s,providerName:c,providerType:m,providerImage:g,ownerWhatsApp:L,initialReviews:Q=[],onBack:T})=>{var I,G,J;const v=typeof window!="undefined"?new URLSearchParams(window.location.search):new URLSearchParams;let h={};if(typeof window!="undefined"){const t=sessionStorage.getItem("reviewParams");if(t)try{h=JSON.parse(t),sessionStorage.removeItem("reviewParams")}catch{}}const V=h.providerId||v.get("providerId")||void 0,X=h.providerName||v.get("providerName")||void 0,Z=h.providerType||v.get("providerType")||void 0,ee=h.providerImage||v.get("providerImage")||void 0,j=(I=s!=null?s:V)!=null?I:"0",N=(G=c!=null?c:X)!=null?G:"Unknown",y=(J=m!=null?m:Z)!=null?J:"therapist",F=g!=null?g:ee,te=()=>{if(T){T();return}typeof window!="undefined"&&(window.location.href="/")},[i,k]=r.useState(Q),[S,f]=r.useState(!1),[ae,$]=r.useState(!0),[M,q]=r.useState(!1),[se,ue]=r.useState(!1),[w,W]=r.useState(""),[u,z]=r.useState(""),[o,B]=r.useState(0),[re,E]=r.useState(0),[x,D]=r.useState(""),[d,O]=r.useState(""),[a,p]=r.useState({});r.useEffect(()=>{(async()=>{try{$(!0);const H=(await K.getByProvider(Number(j),y)).map(l=>({userName:l.reviewerName||"Anonymous",whatsappNumber:l.whatsapp||"",rating:l.rating,reviewText:l.comment||"",avatar:l.avatar||"https://ik.imagekit.io/7grri5v7d/avatar%201.png",date:new Date(l.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),time:new Date(l.createdAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}));k(H)}catch{}finally{$(!1)}})()},[j,y]);const Y=i.length>0?(i.reduce((t,n)=>t+n.rating,0)/i.length).toFixed(1):"0.0",ie=()=>{const t={};return w.trim()||(t.userName="Name is required"),u.trim()?/^\+?[0-9]{10,15}$/.test(u.replace(/\s/g,""))||(t.whatsappNumber="Please enter a valid WhatsApp number"):t.whatsappNumber="WhatsApp number is required",o===0&&(t.rating="Please select a star rating"),x.trim()?x.trim().length<10&&(t.reviewText="Review must be at least 10 characters"):t.reviewText="Review text is required",d||(t.avatar="Please select an avatar"),p(t),Object.keys(t).length===0},le=async()=>{if(ie())try{q(!0),p({});const t=new Date,n={userName:w.trim(),whatsappNumber:u.trim(),rating:o,reviewText:x.trim(),avatar:d,date:t.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),time:t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})};k([n,...i]),await K.createAnonymous({providerId:s||"",providerType:m,rating:o,reviewerName:w.trim(),whatsappNumber:u.trim(),comment:x.trim(),avatar:d});const l=(typeof window!="undefined"?new URLSearchParams(window.location.search):new URLSearchParams).get("returnUrl"),R=j,A=(N||"").toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim();let U="/";if(R&&A&&(y==="place"?U="/profile/place/".concat(R,"-").concat(A):U="/profile/therapist/".concat(R,"-").concat(A)),W(""),z(""),B(0),D(""),O(""),p({}),f(!1),typeof window!="undefined"){const ne=l||U;window.location.href=ne;return}}catch{k(i),p({submit:"Failed to submit review. Please try again."})}finally{q(!1)}};return e.jsxs("div",{className:"min-h-[calc(100vh-env(safe-area-inset-top)-env(safe-area-inset-bottom))] bg-gray-50 ",children:[se&&e.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 animate-slide-down",children:e.jsxs("div",{className:"bg-green-500 text-white px-6 py-4 rounded-lg shadow-2xl flex items-center gap-3",children:[e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Thank you for your review!"}),e.jsx("p",{className:"text-sm text-green-100",children:"Your review has been submitted successfully."})]})]})}),e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:e.jsx(P,{className:"py-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h1",{className:"text-xl sm:text-2xl font-bold",children:[e.jsx("span",{className:"text-gray-900",children:"Inda"}),e.jsx("span",{className:"text-orange-500",children:"street"})]}),e.jsx("button",{onClick:te,className:"p-2 rounded-lg transition-colors text-gray-700 hover:text-orange-500 hover:bg-orange-50 min-h-[44px] min-w-[44px] flex items-center justify-center",children:e.jsx(me,{className:"w-5 h-5 text-orange-600"})})]})})}),e.jsx("div",{className:"bg-white border-b border-gray-200 relative overflow-hidden",children:e.jsxs(P,{className:"py-4",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-1 pr-20 sm:pr-24",children:"Customer Reviews"}),e.jsxs("div",{className:"flex items-center gap-3 pr-20 sm:pr-24",children:[F&&e.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden border-2 border-orange-500 shadow-md flex-shrink-0",children:e.jsx("img",{src:F,alt:N,className:"w-full h-full object-cover"})}),e.jsx("p",{className:"text-gray-600 font-medium",children:N})]})]}),e.jsx("img",{src:"https://ik.imagekit.io/7grri5v7d/reviews.png",alt:"Reviews",className:"absolute bottom-0 right-0 h-16 sm:h-20 md:h-24 w-auto object-contain"})]})}),e.jsx("main",{children:e.jsxs(P,{className:"py-6 space-y-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl font-bold text-gray-900",children:Y}),e.jsx("div",{className:"flex items-center justify-center gap-1 mt-2",children:[1,2,3,4,5].map(t=>e.jsx(C,{className:"w-5 h-5 ".concat(t<=Math.round(parseFloat(Y))?"fill-yellow-400 text-yellow-400":"fill-gray-200 text-gray-300")},t))}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[i.length," ",i.length===1?"review":"reviews"]})]})}),!S&&e.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-bold rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all shadow-lg hover:shadow-xl",children:[e.jsx(b,{className:"w-5 h-5"}),"Leave a Review"]})]})}),S&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border-2 border-orange-200 relative",children:[e.jsx("button",{onClick:()=>{f(!1),p({})},className:"absolute top-4 right-4 w-10 h-10 bg-orange-500 hover:bg-orange-600 text-white rounded-full flex items-center justify-center transition-colors shadow-lg z-10",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[d&&e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center shadow-lg overflow-hidden",children:e.jsx("img",{src:d,alt:"Selected avatar",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"pr-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Write Your Review"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1 max-w-md leading-relaxed",children:"If you feel the service that was offered was not to your satisfaction, we kindly ask you first make contact with the owner as this would be addressed with immediate effect. And send a direct message to the highest authority to make them aware of areas of improvement."}),L&&e.jsxs("a",{href:"https://wa.me/".concat(L.replace(/[^0-9]/g,"")),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 mt-3 px-4 py-2 bg-green-500 hover:bg-green-600 text-white text-sm font-semibold rounded-lg transition-colors shadow-md",children:[e.jsx(_,{className:"w-4 h-4"}),e.jsx("span",{children:"Owner's WhatsApp"})]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx(ge,{className:"w-4 h-4 inline mr-2"}),"Your Name *"]}),e.jsx("input",{type:"text",value:w,onChange:t=>W(t.target.value),placeholder:"Enter your full name",className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent outline-none transition-all ".concat(a.userName?"border-red-500":"border-gray-300")}),a.userName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.userName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx(_,{className:"w-4 h-4 inline mr-2"}),"WhatsApp Number *"]}),e.jsx("input",{type:"tel",value:u,onChange:t=>z(t.target.value),placeholder:"+62 812 3456 7890",className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent outline-none transition-all ".concat(a.whatsappNumber?"border-red-500":"border-gray-300")}),a.whatsappNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.whatsappNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Rating *"}),e.jsxs("div",{className:"flex items-center gap-2 justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",onClick:()=>B(t),onMouseEnter:()=>E(t),onMouseLeave:()=>E(0),className:"transition-transform hover:scale-110",children:e.jsx(C,{className:"w-10 h-10 ".concat(t<=(re||o)?"fill-yellow-400 text-yellow-400":"fill-gray-200 text-gray-300")})},t)),o>0&&e.jsxs("span",{className:"ml-2 text-sm font-medium text-gray-700",children:[o," ",o===1?"Star":"Stars"]})]}),e.jsx("img",{src:"https://ik.imagekit.io/7grri5v7d/reviews.png?updatedAt=1764760532097",alt:"Reviews",className:"w-24 h-24 flex-shrink-0"})]}),a.rating&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.rating})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx(b,{className:"w-4 h-4 inline mr-2"}),"Your Review *"]}),e.jsx("textarea",{value:x,onChange:t=>D(t.target.value),placeholder:"Tell us about your experience...",rows:5,maxLength:500,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent outline-none transition-all resize-none ".concat(a.reviewText?"border-red-500":"border-gray-300")}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsx("div",{children:a.reviewText&&e.jsx("p",{className:"text-red-500 text-xs",children:a.reviewText})}),e.jsxs("p",{className:"text-xs text-gray-500",children:[x.length,"/500 characters"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Choose Your Avatar *"}),e.jsx("div",{className:"grid grid-cols-5 gap-4",children:he.map(t=>e.jsxs("button",{type:"button",onClick:()=>O(t.imageUrl),className:"relative transition-all hover:scale-105 focus:outline-none",children:[e.jsx("img",{src:t.imageUrl,alt:t.label,className:"w-full aspect-square rounded-full object-cover ".concat(d===t.imageUrl?"ring-4 ring-orange-500 ring-offset-2 shadow-lg shadow-orange-500/50":"hover:ring-2 hover:ring-orange-300 hover:ring-offset-2")}),d===t.imageUrl&&e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-orange-500 rounded-full animate-pulse shadow-lg",children:e.jsx("div",{className:"absolute inset-0 bg-orange-500 rounded-full animate-ping opacity-75"})}),e.jsx("div",{className:"text-xs text-gray-600 text-center mt-1",children:t.label})]},t.id))}),a.avatar&&e.jsx("p",{className:"text-red-500 text-xs mt-2",children:a.avatar})]}),a.submit&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-sm",children:a.submit})]}),e.jsx("button",{onClick:le,disabled:M,className:"w-full px-6 py-4 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-bold rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all shadow-lg hover:shadow-xl text-lg disabled:opacity-50 disabled:cursor-not-allowed",children:M?"Submitting...":"Submit Review"})]})]}),e.jsx("div",{className:"space-y-4",children:ae?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading reviews..."})]}):i.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[e.jsx(b,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Reviews Yet"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Be the first to share your experience with ",c]}),!S&&e.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-semibold rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all shadow-lg hover:shadow-xl",children:[e.jsx(b,{className:"w-5 h-5"}),"Write First Review"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mt-8",children:"All Reviews"}),i.map((t,n)=>e.jsx(xe,{review:t},n))]})})]})})]})};export{ye as ReviewsPage,ye as default};
