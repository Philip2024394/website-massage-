import{a as d,j as s}from"./vendor-react.DJgHGAhw.js";import{d as c,A as n}from"./route-therapist.DVVqC6AH.js";import{ID as m}from"./vendor-appwrite.BT2H32tF.js";import"./route-booking.yuk30L8G.js";import"./vendor-misc.BCNplu90.js";import"./route-portals.BJGRQhN_.js";class p{async testDatabaseConnection(){try{return{success:!0,message:"Database connection working",details:{databaseCount:(await c.list()).databases.length,databaseId:n.databaseId}}}catch(e){return{success:!1,message:"Connection failed: ".concat(e.message),details:{error:e,errorMessage:e.message,errorCode:e.code,errorType:e.type}}}}async testMessageCollection(){try{const e=n.collections.messages;if(!e)return{success:!1,message:"Messages collection not configured",details:{collectionId:e}};const o=await c.createDocument(n.databaseId,e,m.unique(),{test:!0,message:"Connection test",createdAt:new Date().toISOString()});return await c.deleteDocument(n.databaseId,e,o.$id),{success:!0,message:"Messages collection working",details:{collectionId:e,testDocumentId:o.$id}}}catch(e){return{success:!1,message:"Messages collection failed: ".concat(e.message),details:{error:e,errorMessage:e.message,errorCode:e.code,collectionId:n.collections.messages}}}}async testBookingsCollection(){try{const e=n.collections.bookings;if(!e)return{success:!1,message:"Bookings collection not configured",details:{collectionId:e}};const o=await c.createDocument(n.databaseId,e,m.unique(),{test:!0,bookingId:"TEST_"+Date.now(),status:"pending",createdAt:new Date().toISOString()});return await c.deleteDocument(n.databaseId,e,o.$id),{success:!0,message:"Bookings collection working",details:{collectionId:e,testDocumentId:o.$id}}}catch(e){return{success:!1,message:"Bookings collection failed: ".concat(e.message),details:{error:e,errorMessage:e.message,errorCode:e.code,collectionId:n.collections.bookings}}}}async runFullDiagnostic(){const e=[],o=await this.testDatabaseConnection();e.push({test:"Database Connection",...o});const i=await this.testMessageCollection();e.push({test:"Messages Collection",...i});const a=await this.testBookingsCollection();e.push({test:"Bookings Collection",...a});const r=e.filter(g=>g.success).length,l=e.length,t="".concat(r,"/").concat(l," tests passed");return{results:e,summary:t}}}const h=new p,C=()=>{const[u,e]=d.useState([]),[o,i]=d.useState(""),[a,r]=d.useState(!1),l=async()=>{r(!0),e([]),i("Running diagnostic...");try{const t=await h.runFullDiagnostic();e(t.results),i(t.summary)}catch(t){e([{test:"Diagnostic Error",success:!1,message:t.message,details:t}]),i("Diagnostic failed")}r(!1)};return d.useEffect(()=>{l()},[]),s.jsxs("div",{style:{padding:"20px",fontFamily:"monospace"},children:[s.jsx("h1",{children:"üî¨ Appwrite Connection Diagnostic"}),s.jsx("div",{style:{marginBottom:"20px"},children:s.jsx("button",{onClick:l,disabled:a,style:{padding:"10px 20px",backgroundColor:a?"#ccc":"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:a?"not-allowed":"pointer"},children:a?"Running...":"Run Diagnostic"})}),s.jsxs("div",{style:{marginBottom:"20px",fontSize:"18px",fontWeight:"bold"},children:["Summary: ",o]}),s.jsxs("div",{style:{background:"#f5f5f5",padding:"15px",borderRadius:"5px"},children:[s.jsx("h3",{children:"Test Results:"}),u.map((t,g)=>s.jsxs("div",{style:{margin:"10px 0",padding:"10px",backgroundColor:t.success?"#d4edda":"#f8d7da",border:"1px solid ".concat(t.success?"#c3e6cb":"#f5c6cb"),borderRadius:"5px"},children:[s.jsxs("h4",{children:[t.success?"‚úÖ":"‚ùå"," ",t.test]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Message:"})," ",t.message]}),t.details&&s.jsxs("details",{children:[s.jsx("summary",{children:"Show Details"}),s.jsx("pre",{style:{fontSize:"12px",overflow:"auto"},children:JSON.stringify(t.details,null,2)})]})]},g))]}),s.jsxs("div",{style:{marginTop:"20px",padding:"15px",backgroundColor:"#fff3cd",borderRadius:"5px"},children:[s.jsx("h4",{children:"üí° What This Tells Us:"}),s.jsxs("ul",{children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Database Connection:"})," Tests if we can connect to Appwrite at all"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Messages Collection:"})," Tests if we can create/delete messages"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Bookings Collection:"})," Tests if we can create/delete bookings"]})]}),s.jsx("p",{children:"If any test fails, we'll see the exact error message and can fix the root cause."})]})]})};export{C as DiagnosticPage};
