import React, { useState, useEffect } from 'react';\nimport { useMobileDetection } from '../hooks/useMobileDetection';\nimport { getDeviceDebugInfo, startViewportMonitoring, createDebugOverlay } from '../utils/deviceDebug';\nimport type { DeviceDebugInfo } from '../utils/deviceDebug';\n\n/**\n * Interactive Device Debug Panel Component\n * Shows live device information with debugging tools\n */\nexport default function DeviceDebugPanel() {\n  const mobile = useMobileDetection();\n  const [debugInfo, setDebugInfo] = useState<DeviceDebugInfo | null>(null);\n  const [isMonitoring, setIsMonitoring] = useState(false);\n  const [hasOverlay, setHasOverlay] = useState(false);\n  const [monitoringCleanup, setMonitoringCleanup] = useState<(() => void) | null>(null);\n  const [overlayCleanup, setOverlayCleanup] = useState<(() => void) | null>(null);\n  const [autoRefresh, setAutoRefresh] = useState(false);\n\n  // Update debug info\n  const updateDebugInfo = () => {\n    setDebugInfo(getDeviceDebugInfo());\n  };\n\n  // Initialize debug info\n  useEffect(() => {\n    updateDebugInfo();\n  }, []);\n\n  // Auto-refresh debug info\n  useEffect(() => {\n    if (autoRefresh) {\n      const interval = setInterval(updateDebugInfo, 1000);\n      return () => clearInterval(interval);\n    }\n  }, [autoRefresh]);\n\n  // Toggle viewport monitoring\n  const toggleMonitoring = () => {\n    if (isMonitoring) {\n      monitoringCleanup?.();\n      setMonitoringCleanup(null);\n      setIsMonitoring(false);\n      console.log('üõë Viewport monitoring stopped');\n    } else {\n      const cleanup = startViewportMonitoring();\n      setMonitoringCleanup(cleanup);\n      setIsMonitoring(true);\n    }\n  };\n\n  // Toggle debug overlay\n  const toggleOverlay = () => {\n    if (hasOverlay) {\n      overlayCleanup?.();\n      setOverlayCleanup(null);\n      setHasOverlay(false);\n    } else {\n      const cleanup = createDebugOverlay();\n      setOverlayCleanup(cleanup);\n      setHasOverlay(true);\n    }\n  };\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      monitoringCleanup?.();\n      overlayCleanup?.();\n    };\n  }, [monitoringCleanup, overlayCleanup]);\n\n  // Enable debug logging on mobile detection changes\n  useEffect(() => {\n    mobile.debug.setLogOnChange(true);\n    return () => mobile.debug.setLogOnChange(false);\n  }, [mobile.debug]);\n\n  if (!debugInfo) {\n    return (\n      <div className=\"p-6 bg-gray-50 rounded-lg\">\n        <div className=\"animate-pulse\">Loading debug info...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 bg-gray-50 min-h-screen\">\n      <div className=\"max-w-6xl mx-auto\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h1 className=\"text-3xl font-bold flex items-center gap-2\">\n            üîç Device Debug Panel\n          </h1>\n          \n          {/* Debug Controls */}\n          <div className=\"flex gap-2 flex-wrap\">\n            <button\n              onClick={updateDebugInfo}\n              className=\"px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600\"\n            >\n              üîÑ Refresh\n            </button>\n            \n            <button\n              onClick={() => setAutoRefresh(!autoRefresh)}\n              className={`px-3 py-1 rounded text-sm ${\n                autoRefresh \n                  ? 'bg-green-500 text-white hover:bg-green-600' \n                  : 'bg-gray-300 text-gray-700 hover:bg-gray-400'\n              }`}\n            >\n              {autoRefresh ? '‚è∏Ô∏è Stop Auto' : '‚ñ∂Ô∏è Auto Refresh'}\n            </button>\n            \n            <button\n              onClick={toggleMonitoring}\n              className={`px-3 py-1 rounded text-sm ${\n                isMonitoring \n                  ? 'bg-red-500 text-white hover:bg-red-600' \n                  : 'bg-yellow-500 text-white hover:bg-yellow-600'\n              }`}\n            >\n              {isMonitoring ? '‚èπÔ∏è Stop Monitor' : 'üëÅÔ∏è Monitor'}\n            </button>\n            \n            <button\n              onClick={toggleOverlay}\n              className={`px-3 py-1 rounded text-sm ${\n                hasOverlay \n                  ? 'bg-purple-500 text-white hover:bg-purple-600' \n                  : 'bg-indigo-500 text-white hover:bg-indigo-600'\n              }`}\n            >\n              {hasOverlay ? 'üö´ Hide Overlay' : 'üìä Show Overlay'}\n            </button>\n            \n            <button\n              onClick={() => mobile.debug.log('Manual Debug Log')}\n              className=\"px-3 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700\"\n            >\n              üìù Log to Console\n            </button>\n          </div>\n        </div>\n\n        {/* Status Indicators */}\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\n          <div className={`p-3 rounded-lg text-center ${mobile.isMobileDevice ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-600'}`}>\n            <div className=\"text-2xl mb-1\">{mobile.isMobileDevice ? 'üì±' : 'üñ•Ô∏è'}</div>\n            <div className=\"text-sm font-medium\">{mobile.isMobileDevice ? 'Mobile Device' : 'Desktop Device'}</div>\n          </div>\n          \n          <div className={`p-3 rounded-lg text-center ${debugInfo.touchSupport ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\n            <div className=\"text-2xl mb-1\">{debugInfo.touchSupport ? 'üëÜ' : 'üñ±Ô∏è'}</div>\n            <div className=\"text-sm font-medium\">{debugInfo.touchSupport ? 'Touch Enabled' : 'No Touch'}</div>\n          </div>\n          \n          <div className={`p-3 rounded-lg text-center ${mobile.isPortrait ? 'bg-purple-100 text-purple-800' : 'bg-orange-100 text-orange-800'}`}>\n            <div className=\"text-2xl mb-1\">{mobile.isPortrait ? 'üì±' : 'üì±'}</div>\n            <div className=\"text-sm font-medium\">{mobile.isPortrait ? 'Portrait' : 'Landscape'}</div>\n          </div>\n          \n          <div className={`p-3 rounded-lg text-center ${debugInfo.isStandalone ? 'bg-indigo-100 text-indigo-800' : 'bg-gray-100 text-gray-600'}`}>\n            <div className=\"text-2xl mb-1\">{debugInfo.isStandalone ? 'üìå' : 'üåê'}</div>\n            <div className=\"text-sm font-medium\">{debugInfo.isStandalone ? 'PWA Mode' : 'Browser'}</div>\n          </div>\n        </div>\n\n        {/* Main Debug Grid */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          \n          {/* Dimensions */}\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"font-bold mb-4 text-lg flex items-center gap-2\">\n              üìè Dimensions\n            </h3>\n            <div className=\"space-y-2 text-sm font-mono\">\n              <div className=\"flex justify-between\">\n                <span>Window:</span>\n                <span className=\"font-bold\">{debugInfo.windowWidth}√ó{debugInfo.windowHeight}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Screen:</span>\n                <span className=\"font-bold\">{debugInfo.screenWidth}√ó{debugInfo.screenHeight}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Device Pixel Ratio:</span>\n                <span className=\"font-bold\">{debugInfo.devicePixelRatio}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>1vh:</span>\n                <span className=\"font-bold\">{debugInfo.vhUnit}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>1vw:</span>\n                <span className=\"font-bold\">{debugInfo.vwUnit}</span>\n              </div>\n              {debugInfo.visualViewport && (\n                <div className=\"mt-4 pt-2 border-t\">\n                  <div className=\"font-semibold mb-2\">Visual Viewport:</div>\n                  <div className=\"flex justify-between\">\n                    <span>Size:</span>\n                    <span className=\"font-bold\">{debugInfo.visualViewport.width}√ó{debugInfo.visualViewport.height}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Offset:</span>\n                    <span className=\"font-bold\">{debugInfo.visualViewport.offsetLeft},{debugInfo.visualViewport.offsetTop}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Scale:</span>\n                    <span className=\"font-bold\">{debugInfo.visualViewport.scale}</span>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Capabilities */}\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"font-bold mb-4 text-lg flex items-center gap-2\">\n              üéØ Capabilities\n            </h3>\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between items-center\">\n                <span>Touch Support:</span>\n                <span className={`px-2 py-1 rounded text-xs ${debugInfo.touchSupport ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\n                  {debugInfo.touchSupport ? '‚úÖ Yes' : '‚ùå No'}\n                </span>\n              </div>\n              <div className=\"flex justify-between items-center\">\n                <span>Max Touch Points:</span>\n                <span className=\"font-mono\">{debugInfo.maxTouchPoints}</span>\n              </div>\n              <div className=\"flex justify-between items-center\">\n                <span>Hover Support:</span>\n                <span className={`px-2 py-1 rounded text-xs ${debugInfo.hoverSupport ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\n                  {debugInfo.hoverSupport ? '‚úÖ Yes' : '‚ùå No'}\n                </span>\n              </div>\n              <div className=\"flex justify-between items-center\">\n                <span>Pointer Events:</span>\n                <span className={`px-2 py-1 rounded text-xs ${debugInfo.pointerSupport ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\n                  {debugInfo.pointerSupport ? '‚úÖ Yes' : '‚ùå No'}\n                </span>\n              </div>\n              <div className=\"flex justify-between items-center\">\n                <span>Online Status:</span>\n                <span className={`px-2 py-1 rounded text-xs ${debugInfo.onlineStatus ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\n                  {debugInfo.onlineStatus ? 'üü¢ Online' : 'üî¥ Offline'}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* CSS Support */}\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"font-bold mb-4 text-lg flex items-center gap-2\">\n              üé® CSS Support\n            </h3>\n            <div className=\"space-y-2 text-sm\">\n              {[\n                { name: 'Viewport Units', value: debugInfo.supportsViewportUnits },\n                { name: 'Safe Area Insets', value: debugInfo.supportsSafeArea },\n                { name: 'CSS Grid', value: debugInfo.supportsGrid },\n                { name: 'Flexbox', value: debugInfo.supportsFlex }\n              ].map(({ name, value }) => (\n                <div key={name} className=\"flex justify-between items-center\">\n                  <span>{name}:</span>\n                  <span className={`px-2 py-1 rounded text-xs ${value ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\n                    {value ? '‚úÖ Supported' : '‚ùå Not Supported'}\n                  </span>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Enhanced Detection */}\n          {debugInfo.enhancedDetection && (\n            <div className=\"bg-white p-6 rounded-lg shadow\">\n              <h3 className=\"font-bold mb-4 text-lg flex items-center gap-2\">\n                üî¨ Enhanced Detection\n              </h3>\n              <div className=\"space-y-2 text-sm\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <div className=\"font-semibold mb-2\">Device:</div>\n                    <div className=\"space-y-1\">\n                      <div className={debugInfo.enhancedDetection.isMobile ? 'text-green-600' : 'text-gray-400'}>\n                        üì± Mobile: {debugInfo.enhancedDetection.isMobile ? '‚úÖ' : '‚ùå'}\n                      </div>\n                      <div className={debugInfo.enhancedDetection.isAndroid ? 'text-green-600' : 'text-gray-400'}>\n                        ü§ñ Android: {debugInfo.enhancedDetection.isAndroid ? '‚úÖ' : '‚ùå'}\n                      </div>\n                      <div className={debugInfo.enhancedDetection.isIOS ? 'text-green-600' : 'text-gray-400'}>\n                        üçé iOS: {debugInfo.enhancedDetection.isIOS ? '‚úÖ' : '‚ùå'}\n                      </div>\n                    </div>\n                  </div>\n                  <div>\n                    <div className=\"font-semibold mb-2\">Browser:</div>\n                    <div className=\"space-y-1\">\n                      <div className={debugInfo.enhancedDetection.isSafari ? 'text-green-600' : 'text-gray-400'}>\n                        üß≠ Safari: {debugInfo.enhancedDetection.isSafari ? '‚úÖ' : '‚ùå'}\n                      </div>\n                      <div className={debugInfo.enhancedDetection.isChrome ? 'text-green-600' : 'text-gray-400'}>\n                        üåê Chrome: {debugInfo.enhancedDetection.isChrome ? '‚úÖ' : '‚ùå'}\n                      </div>\n                      <div className={debugInfo.enhancedDetection.isFirefox ? 'text-green-600' : 'text-gray-400'}>\n                        ü¶ä Firefox: {debugInfo.enhancedDetection.isFirefox ? '‚úÖ' : '‚ùå'}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Applied CSS Classes */}\n        <div className=\"mt-6 bg-white p-6 rounded-lg shadow\">\n          <h3 className=\"font-bold mb-4 text-lg flex items-center gap-2\">\n            üè∑Ô∏è Applied CSS Classes\n          </h3>\n          <div className=\"bg-gray-50 p-4 rounded font-mono text-sm\">\n            <div className=\"text-blue-600 mb-2\">document.body.classList:</div>\n            <div className=\"flex flex-wrap gap-2\">\n              {[\n                mobile.isMobileDevice && 'mobile-device',\n                mobile.isTabletDevice && 'tablet-device', \n                mobile.isDesktopDevice && 'desktop-device',\n                mobile.isMobileScreen && 'mobile-screen',\n                mobile.isSmallScreen && 'small-screen',\n                mobile.isMediumScreen && 'medium-screen',\n                mobile.isLargeScreen && 'large-screen',\n                mobile.isPortrait && 'portrait',\n                mobile.isLandscape && 'landscape',\n                mobile.hasTouch && 'has-touch',\n                mobile.hasHover && 'has-hover',\n                (mobile.isMobileScreen || mobile.isMobileDevice) && 'mobile-lock'\n              ].filter(Boolean).map(className => (\n                <span key={className} className=\"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs\">\n                  .{className}\n                </span>\n              ))}\n            </div>\n          </div>\n        </div>\n\n        {/* User Agent */}\n        <div className=\"mt-6 bg-white p-6 rounded-lg shadow\">\n          <h3 className=\"font-bold mb-4 text-lg flex items-center gap-2\">\n            üè∑Ô∏è User Agent\n          </h3>\n          <div className=\"bg-gray-50 p-4 rounded font-mono text-xs break-all\">\n            {debugInfo.userAgent}\n          </div>\n          <div className=\"mt-2 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\n            <div>\n              <span className=\"font-semibold\">Platform:</span> {debugInfo.platform}\n            </div>\n            <div>\n              <span className=\"font-semibold\">Language:</span> {debugInfo.language}\n            </div>\n            <div>\n              <span className=\"font-semibold\">Cookies:</span> {debugInfo.cookieEnabled ? '‚úÖ Enabled' : '‚ùå Disabled'}\n            </div>\n          </div>\n        </div>\n\n        {/* Instructions */}\n        <div className=\"mt-6 bg-yellow-50 border border-yellow-200 p-4 rounded-lg\">\n          <h4 className=\"font-semibold text-yellow-800 mb-2\">üß™ Testing Tools Available</h4>\n          <div className=\"text-sm text-yellow-700 space-y-1\">\n            <div>‚Ä¢ <span className=\"font-mono\">window.debugDevice.log()</span> - Log comprehensive device info</div>\n            <div>‚Ä¢ <span className=\"font-mono\">window.debugDevice.quick()</span> - Quick device debug log</div>\n            <div>‚Ä¢ <span className=\"font-mono\">window.debugDevice.monitor()</span> - Start viewport monitoring</div>\n            <div>‚Ä¢ <span className=\"font-mono\">window.debugDevice.overlay()</span> - Create debug overlay</div>\n            <div>‚Ä¢ Use the controls above to enable real-time monitoring and overlays</div>\n            <div>‚Ä¢ Resize browser window or rotate device to see changes</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}