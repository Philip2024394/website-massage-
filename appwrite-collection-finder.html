<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç Appwrite Collection ID Finder</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .alert {
            background: #fee;
            border: 2px solid #f44;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            color: #800;
        }
        
        .success {
            background: #efe;
            border: 2px solid #4a4;
            color: #040;
        }
        
        .warning {
            background: #ffa;
            border: 2px solid #fa4;
            color: #840;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        #results {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            margin-top: 20px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .step {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .step h3 {
            margin-top: 0;
            color: #667eea;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: monospace;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Appwrite Collection ID Finder</h1>
        
        <div class="alert">
            <strong>‚ùå CRITICAL ISSUE DETECTED:</strong><br>
            Your Appwrite configuration has placeholder collection IDs like <code>'therapists_collection_id'</code> instead of real collection IDs. This is why therapist data isn't persisting!
        </div>

        <div class="step">
            <h3>üö® The Problem</h3>
            <p>Your <code>lib/appwrite.config.ts</code> file contains:</p>
            <div class="code-block">
collections: {
    therapists: 'therapists_collection_id', // ‚ùå Placeholder
    places: 'places_collection_id',        // ‚ùå Placeholder
    // ... all other collections are placeholders
}
            </div>
            <p>These are <strong>placeholder values</strong> - not real collection IDs from your Appwrite database!</p>
        </div>

        <div class="step">
            <h3>üîß How to Fix</h3>
            <p><strong>Step 1:</strong> Go to your Appwrite console</p>
            <p><strong>Step 2:</strong> Navigate to: <code>Databases ‚Üí [Your Database] ‚Üí Collections</code></p>
            <p><strong>Step 3:</strong> Find each collection and copy its real ID (looks like: <code>68f76ee1000e64ca8d05</code>)</p>
            <p><strong>Step 4:</strong> Replace the placeholders with real IDs</p>
        </div>

        <div class="step">
            <h3>üìã Collections You Need to Find</h3>
            <ul>
                <li><strong>therapists</strong> - Main therapist profiles collection</li>
                <li><strong>places</strong> - Place/spa profiles collection</li>
                <li><strong>bookings</strong> - Customer bookings</li>
                <li><strong>notifications</strong> - System notifications</li>
                <li><strong>users</strong> - Customer accounts</li>
            </ul>
        </div>

        <div class="step">
            <h3>üéØ Quick Fix Template</h3>
            <p>Once you have the real collection IDs, update your config like this:</p>
            <div class="code-block">
// In lib/appwrite.config.ts
export const APPWRITE_CONFIG = {
    // ... existing config
    collections: {
        therapists: '68f76ee1000e64ca8d05', // ‚Üê Real ID from Appwrite
        places: '68f76ee1000e64ca8d06',     // ‚Üê Real ID from Appwrite  
        bookings: '68f76ee1000e64ca8d07',   // ‚Üê Real ID from Appwrite
        // ... update all other collections
    },
    // ...
};
            </div>
        </div>

        <button onclick="testConnection()">üîç Test Current Appwrite Connection</button>
        <button onclick="generateFixScript()">üõ†Ô∏è Generate Collection Finder Script</button>
        <button onclick="showQuickFix()">‚ö° Show Quick Fix Guide</button>

        <div id="results"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.1"></script>
    <script>
        const resultsDiv = document.getElementById('results');
        
        function addToResults(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            resultsDiv.textContent += `[${timestamp}] ${prefix} ${message}\n`;
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        }
        
        function clearResults() {
            resultsDiv.textContent = '';
        }
        
        async function testConnection() {
            clearResults();
            addToResults('Testing Appwrite connection...');
            
            try {
                const { Client, Databases } = Appwrite;
                
                const client = new Client()
                    .setEndpoint('https://syd.cloud.appwrite.io/v1')
                    .setProject('68f23b11000d25eb3664');
                
                const databases = new Databases(client);
                
                addToResults('‚úÖ Appwrite client initialized successfully');
                addToResults('üìä Project ID: 68f23b11000d25eb3664');
                addToResults('üåê Endpoint: https://syd.cloud.appwrite.io/v1');
                
                // Try to list databases
                try {
                    addToResults('üîç Attempting to connect to database...');
                    
                    // Since we can't list databases without admin permissions,
                    // we'll try to access the known database
                    addToResults('üìã Database ID in config: 68f76ee1000e64ca8d05');
                    addToResults('‚ö†Ô∏è Cannot verify collections without proper collection IDs');
                    addToResults('');
                    addToResults('üéØ NEXT STEPS:');
                    addToResults('1. Login to https://syd.cloud.appwrite.io');
                    addToResults('2. Go to: Databases ‚Üí Your Database ‚Üí Collections');
                    addToResults('3. Copy the real collection IDs (not placeholder names)');
                    addToResults('4. Update lib/appwrite.config.ts with real IDs');
                    
                } catch (error) {
                    addToResults(`‚ùå Database access error: ${error.message}`, 'error');
                }
                
            } catch (error) {
                addToResults(`‚ùå Connection failed: ${error.message}`, 'error');
            }
        }
        
        function generateFixScript() {
            clearResults();
            addToResults('üõ†Ô∏è COLLECTION ID FINDER SCRIPT');
            addToResults('=====================================');
            addToResults('');
            addToResults('Copy this script and run it in your Appwrite console:');
            addToResults('');
            addToResults('// Paste this in browser console on Appwrite dashboard');
            addToResults('function findCollections() {');
            addToResults('    console.log("üîç FINDING COLLECTION IDS:");');
            addToResults('    console.log("============================");');
            addToResults('    ');
            addToResults('    // Look for collection elements in the UI');
            addToResults('    const collections = document.querySelectorAll("[data-collection-id], .collection-item, .collection-row");');
            addToResults('    ');
            addToResults('    collections.forEach(el => {');
            addToResults('        const id = el.dataset.collectionId || el.textContent.match(/[a-f0-9]{24}/)?.[0];');
            addToResults('        if (id) console.log("Found collection ID:", id);');
            addToResults('    });');
            addToResults('    ');
            addToResults('    // Also check URL for collection IDs');
            addToResults('    const urlId = window.location.pathname.match(/collections\/([a-f0-9]+)/)?.[1];');
            addToResults('    if (urlId) console.log("URL collection ID:", urlId);');
            addToResults('}');
            addToResults('');
            addToResults('findCollections();');
        }
        
        function showQuickFix() {
            clearResults();
            addToResults('‚ö° QUICK FIX GUIDE');
            addToResults('==================');
            addToResults('');
            addToResults('1. üåê Open https://syd.cloud.appwrite.io');
            addToResults('2. üîë Login to your account');
            addToResults('3. üìä Navigate to: Databases');
            addToResults('4. üìÅ Click on your database (ID: 68f76ee1000e64ca8d05)');
            addToResults('5. üìã Click "Collections" tab');
            addToResults('6. üìù For each collection, copy its ID (long alphanumeric string)');
            addToResults('');
            addToResults('7. üîß Update your lib/appwrite.config.ts file:');
            addToResults('');
            addToResults('   therapists: "PASTE_REAL_THERAPISTS_COLLECTION_ID_HERE",');
            addToResults('   places: "PASTE_REAL_PLACES_COLLECTION_ID_HERE",');
            addToResults('   bookings: "PASTE_REAL_BOOKINGS_COLLECTION_ID_HERE",');
            addToResults('   notifications: "PASTE_REAL_NOTIFICATIONS_COLLECTION_ID_HERE",');
            addToResults('');
            addToResults('8. üíæ Save the file');
            addToResults('9. üîÑ Restart your dev server: npm run dev');
            addToResults('10. ‚úÖ Test therapist profile saving again');
            addToResults('');
            addToResults('üéâ Your therapist data should now persist correctly!');
        }
        
        // Auto-run connection test on page load
        window.onload = function() {
            addToResults('üîç Appwrite Collection ID Finder Ready');
            addToResults('Click "Test Current Connection" to check your setup');
        };
    </script>
</body>
</html>