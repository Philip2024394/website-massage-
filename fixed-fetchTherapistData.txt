    const fetchTherapistData = useCallback(async () => {
        setIsLoading(true);
        
        try {
            console.log('ðŸ“– Fetching therapist data for ID:', therapistId);
            let existingTherapist = null;
            
            // ðŸŽ¯ PRIORITY 1: Use existingTherapistData from AppRouter (best source)
            if (existingTherapistData) {
                console.log('âœ… Using existingTherapistData from AppRouter (live home data)');
                existingTherapist = existingTherapistData;
            } else {
                // ðŸŽ¯ PRIORITY 2: Try direct document lookup by therapistId 
                try {
                    console.log('ðŸ” Trying direct document lookup by ID:', therapistId);
                    existingTherapist = await therapistService.getById(therapistId.toString());
                    if (existingTherapist) {
                        console.log('âœ… Found therapist by direct ID lookup:', existingTherapist.name);
                    }
                } catch (directError) {
                    console.log('âš ï¸ Direct ID lookup failed:', directError);
                }
                
                // ðŸŽ¯ PRIORITY 3: Email lookup fallback (CRITICAL FIX for ID mismatch)
                if (!existingTherapist) {
                    try {
                        console.log('ðŸ†˜ CRITICAL FIX: No therapist found by ID, forcing email lookup...');
                        const currentUser = await therapistService.getCurrentUser();
                        if (currentUser?.email) {
                            console.log('ðŸ“§ FORCE: Fetching therapist by authenticated user email:', currentUser.email);
                            const emailTherapists = await therapistService.getByEmail(currentUser.email);
                            if (emailTherapists && emailTherapists.length > 0) {
                                existingTherapist = emailTherapists[0];
                                console.log('âœ… CRITICAL SUCCESS: Found therapist by email:', {
                                    name: existingTherapist.name,
                                    id: existingTherapist.$id,
                                    email: existingTherapist.email
                                });
                            }
                        }
                    } catch (criticalError: any) {
                        console.error('âŒ CRITICAL ERROR in email lookup:', criticalError?.message || criticalError);
                    }
                }
            }

            if (existingTherapist) {
                console.log('âœ… Found existing therapist profile:', existingTherapist);
                setTherapist(existingTherapist);
                
                // Set form fields only if currently empty
                if (!name || name === '') {
                    setName(existingTherapist.name || '');
                }
                if (!description || description === '') {
                    setDescription(existingTherapist.description || '');
                }
                if (!profilePicture || profilePicture === '') {
                    setProfilePicture(existingTherapist.profilePicture || '');
                }
                
                setWhatsappNumber(existingTherapist.whatsappNumber || '');
                setLocation(existingTherapist.location || '');
                setYearsOfExperience((existingTherapist as any).yearsOfExperience || 0);
                setMassageTypes(parseMassageTypes(existingTherapist.massageTypes));
                setLanguages(existingTherapist.languages 
                    ? (typeof existingTherapist.languages === 'string' 
                        ? parseLanguages(existingTherapist.languages) 
                        : existingTherapist.languages)
                    : []);
                
                // Load pricing
                const loadedPricing = (() => {
                    if (existingTherapist.price60 !== undefined || existingTherapist.price90 !== undefined || existingTherapist.price120 !== undefined) {
                        return {
                            "60": existingTherapist.price60 ? parseInt(existingTherapist.price60) * 1000 : 0,
                            "90": existingTherapist.price90 ? parseInt(existingTherapist.price90) * 1000 : 0,
                            "120": existingTherapist.price120 ? parseInt(existingTherapist.price120) * 1000 : 0
                        };
                    }
                    return parsePricing(existingTherapist.pricing);
                })();
                setPricing(loadedPricing);
                
                // Load hotel/villa pricing
                if ((existingTherapist as any).hotelVillaPricing) {
                    setHotelVillaPricing(parsePricing((existingTherapist as any).hotelVillaPricing));
                    setUseSamePricing(false);
                } else {
                    setHotelVillaPricing(parsePricing(existingTherapist.pricing));
                    setUseSamePricing(true);
                }
                
                setCoordinates(parseCoordinates(existingTherapist.coordinates));
                const therapistStatus = existingTherapist.status || AvailabilityStatus.Offline;
                setStatus(therapistStatus);
                setIsLicensed((existingTherapist as any).isLicensed || false);
                setLicenseNumber((existingTherapist as any).licenseNumber || '');
                
                // Load discount data from analytics
                try {
                    const analyticsData = existingTherapist.analytics ? 
                        (typeof existingTherapist.analytics === 'string' ? JSON.parse(existingTherapist.analytics) : existingTherapist.analytics) : 
                        {};
                    
                    if (analyticsData.discountData) {
                        const discountData = analyticsData.discountData;
                        const endTime = new Date(discountData.endTime);
                        const now = new Date();
                        
                        if (discountData.isActive && endTime > now) {
                            setDiscountPercentage(discountData.percentage);
                            setDiscountDuration(discountData.duration);
                            setDiscountEndTime(endTime);
                            setIsDiscountActive(true);
                        } else if (discountData.isActive && endTime <= now) {
                            setDiscountPercentage(0);
                            setDiscountDuration(0);
                            setDiscountEndTime(null);
                            setIsDiscountActive(false);
                            
                            const updatedAnalytics = {
                                ...analyticsData,
                                discountData: { ...discountData, isActive: false }
                            };
                            therapistService.update(therapistId.toString(), { 
                                analytics: JSON.stringify(updatedAnalytics)
                            });
                        }
                    }
                } catch (error) {
                    console.error('âŒ Error loading discount data:', error);
                }
            } else {
                console.log('ðŸ“ No existing profile found, starting with empty form');
                
                const emptyTherapist = {
                    id: therapistId,
                    name: '',
                    description: '',
                    profilePicture: '',
                    whatsappNumber: '',
                    massageTypes: stringifyMassageTypes([]),
                    pricing: stringifyPricing({ "60": 0, "90": 0, "120": 0 }),
                    location: '',
                    coordinates: stringifyCoordinates({ lat: 0, lng: 0 }),
                    status: AvailabilityStatus.Offline,
                    isLive: true,
                    rating: 0,
                    reviewCount: 0,
                    activeMembershipDate: new Date().toISOString().split('T')[0],
                    email: `therapist${therapistId}@indostreet.com`,
                    distance: 0,
                    analytics: stringifyAnalytics({ 
                      impressions: 0, views: 0, profileViews: 0,
                      whatsapp_clicks: 0, whatsappClicks: 0,
                      phone_clicks: 0, directions_clicks: 0, bookings: 0 
                    }),
                };
                
                setTherapist(emptyTherapist);
                setName('');
                setDescription('');
                setProfilePicture('');
                setWhatsappNumber('');
                setYearsOfExperience(0);
                setMassageTypes([]);
                setLanguages([]);
                setPricing({ "60": 0, "90": 0, "120": 0 });
                setHotelVillaPricing({ "60": 0, "90": 0, "120": 0 });
                setUseSamePricing(true);
                setLocation('');
                setCoordinates({ lat: 0, lng: 0 });
                setStatus(AvailabilityStatus.Offline);
                setIsLicensed(false);
                setLicenseNumber('');
            }
            
            setDataLoaded(true);
            
        } catch (error) {
            console.error('âŒ Error fetching therapist data:', error);
            setDataLoaded(true);
        } finally {
            setIsLoading(false);
        }
    }, [therapistId, existingTherapistData]);